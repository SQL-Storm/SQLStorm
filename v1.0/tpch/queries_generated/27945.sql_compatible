
WITH RECURSIVE StringBench AS (
    SELECT 
        p.p_partkey,
        p.p_name,
        p.p_comment,
        CONCAT('Processed: ', p.p_name) AS processed_name,
        REPLACE(p.p_comment, 'nice', 'great') AS modified_comment,
        LENGTH(p.p_comment) AS original_length,
        LENGTH(REPLACE(p.p_comment, 'nice', 'great')) AS modified_length
    FROM 
        part p
    WHERE 
        LENGTH(p.p_comment) > 0
    
    UNION ALL
    
    SELECT 
        sb.p_partkey,
        CONCAT(sb.processed_name, ' - Iteration ', COUNT(*)) AS processed_name,
        sb.modified_comment,
        CONCAT(sb.processed_name, ' - Iteration ', COUNT(*)) AS processed_name,
        sb.modified_comment,
        sb.original_length,
        sb.modified_length
    FROM 
        StringBench sb
    GROUP BY 
        sb.p_partkey, sb.processed_name, sb.modified_comment, sb.original_length, sb.modified_length
)
SELECT 
    sb.p_partkey,
    sb.processed_name,
    sb.modified_comment,
    sb.original_length,
    sb.modified_length,
    sb.modified_length - sb.original_length AS length_difference
FROM 
    StringBench sb
WHERE 
    sb.original_length < sb.modified_length
ORDER BY 
    length_difference DESC
LIMIT 10;
