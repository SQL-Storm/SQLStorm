
WITH TagStats AS (
    SELECT
        t.TagName,
        COUNT(p.Id) AS PostCount,
        STRING_AGG(DISTINCT CONCAT(u.DisplayName, ' (', u.Reputation, ')'), ', ') AS Contributors,
        MAX(p.Views) AS MaxViews,
        AVG(p.Score) AS AvgScore
    FROM
        Tags t
    JOIN 
        Posts p ON p.Tags LIKE CONCAT('%<', t.TagName, '>%' )
    JOIN 
        Users u ON p.OwnerUserId = u.Id
    WHERE
        p.PostTypeId = 1 
    GROUP BY
        t.TagName
),
TopTags AS (
    SELECT 
        TagName,
        PostCount,
        Contributors,
        MaxViews,
        AvgScore,
        RANK() OVER (ORDER BY PostCount DESC) AS Rank
    FROM 
        TagStats
)
SELECT 
    TagName,
    PostCount,
    Contributors,
    MaxViews,
    AvgScore
FROM 
    TopTags
WHERE 
    Rank <= 10
ORDER BY 
    PostCount DESC;
