
SELECT 
    P.Id AS PostID,
    P.Title AS PostTitle,
    P.CreationDate AS PostCreationDate,
    U.DisplayName AS OwnerDisplayName,
    P.Score AS PostScore,
    P.ViewCount AS PostViewCount,
    COALESCE(C.Count, 0) AS CommentCount,
    COALESCE(B.Count, 0) AS BadgeCount,
    COALESCE(T.Count, 0) AS TagCount
FROM 
    Posts P
LEFT JOIN 
    Users U ON P.OwnerUserId = U.Id
LEFT JOIN 
    (SELECT PostId, COUNT(*) AS Count FROM Comments GROUP BY PostId) C ON P.Id = C.PostId
LEFT JOIN 
    (SELECT UserId, COUNT(*) AS Count FROM Badges GROUP BY UserId) B ON U.Id = B.UserId
LEFT JOIN 
    (SELECT Id, COUNT(*) AS Count FROM Tags GROUP BY Id) T ON P.Tags LIKE CONCAT('%', T.TagName, '%')
WHERE 
    P.CreationDate >= CAST('2023-01-01' AS DATE)
GROUP BY 
    P.Id, P.Title, P.CreationDate, U.DisplayName, P.Score, P.ViewCount
ORDER BY 
    P.CreationDate DESC
LIMIT 100;
