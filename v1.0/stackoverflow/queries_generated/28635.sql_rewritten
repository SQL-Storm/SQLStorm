WITH TagStatistics AS (
    SELECT 
        Tags.TagName, 
        COUNT(Posts.Id) AS PostCount, 
        SUM(Posts.AnswerCount) AS TotalAnswers,
        AVG(Posts.Score) AS AvgScore,
        STRING_AGG(DISTINCT Users.DisplayName, ', ') AS ContributingUsers
    FROM 
        Tags
    JOIN 
        Posts ON Tags.Id = ANY(string_to_array(Posts.Tags, ',')::int[])
    JOIN 
        Users ON Posts.OwnerUserId = Users.Id 
    GROUP BY 
        Tags.TagName
),
TopTags AS (
    SELECT 
        TagName, 
        PostCount, 
        TotalAnswers, 
        AvgScore, 
        ContributingUsers,
        ROW_NUMBER() OVER (ORDER BY PostCount DESC) AS Rank
    FROM 
        TagStatistics
)
SELECT 
    Rank, 
    TagName, 
    PostCount, 
    TotalAnswers, 
    AvgScore, 
    ContributingUsers
FROM 
    TopTags
WHERE 
    Rank <= 10
ORDER BY 
    Rank;