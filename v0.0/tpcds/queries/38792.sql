
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41781','34519','65836','85590','16266','74161',
                          '28850','47316','92275','63457','87808',
                          '57586','64049','17882','21276','49183',
                          '90576','79498','50039','75923','44359',
                          '32968','99276','43352','71861','18933',
                          '20221','83967','90927','84615','81429',
                          '38589','42401','87018','43992','62685',
                          '95684','17597','17631','24482','16321',
                          '72774','19113','46839','80475','40455',
                          '54481','54928','73368','31965','70589',
                          '15984','28655','29738','13989','46085',
                          '93541','48007','92523','40681','92606',
                          '92271','66298','28271','67992','24254',
                          '15377','36457','86119','53068','31342',
                          '78119','51829','30719','48242','17981',
                          '83401','60976','30458','53142','38850',
                          '69753','24747','64821','67247','34636',
                          '97988','23546','38342','20830','23477',
                          '22592','53956','11350','72310','39021',
                          '23429','47882','81828','51388','62205',
                          '13711','10541','17075','14145','29720',
                          '43147','55040','43778','24739','21747',
                          '29702','27545','15783','55101','95959',
                          '34275','95133','66968','15711','12774',
                          '85849','36300','19964','55936','22492',
                          '30535','24547','47463','36386','88922',
                          '63100','10650','63926','31220','92732',
                          '33473','33730','17006','11648','98441',
                          '58388','13354','25256','83211','30767',
                          '62878','86323','69268','19130','62451',
                          '11460','69775','20104','17839','66101',
                          '10411','64455','41526','67528','58697',
                          '54307','88362','40594','47443','11848',
                          '36351','51314','91437','58080','16901',
                          '75864','23879','51480','10985','58665',
                          '45109','46744','58286','45863','72723',
                          '59621','32521','53760','42301','18708',
                          '25248','22876','50926','30156','33615',
                          '69938','48131','61816','49275','81764',
                          '22173','68105','69475','15848','48645',
                          '80061','55713','26809','50227','21887',
                          '30024','55714','18553','45492','72373',
                          '33854','49049','23832','45868','95757',
                          '68701','37636','58695','29982','61118',
                          '21193','35150','41228','77306','93670',
                          '32699','69309','57440','98521','16184',
                          '58079','98577','34271','89244','37845',
                          '66655','59823','21557','53581','75072',
                          '19859','65320','69066','75045','12122',
                          '42987','56818','25870','46397','43344',
                          '63113','23300','97711','82780','39377',
                          '27358','33841','52551','60041','73421',
                          '38456','97691','62421','32280','21744',
                          '49273','36689','51940','26353','64740',
                          '29670','47533','46559','73098','24476',
                          '86260','44303','55801','26752','47781',
                          '73067','61033','19594','16168','52183',
                          '76101','72712','28045','79778','61274',
                          '94869','60619','85416','16049','19385',
                          '54951','93312','37108','23936','98768',
                          '10476','21931','27523','24458','31850',
                          '16963','30760','36549','30337','74435',
                          '92037','70937','41710','99138','14147',
                          '32917','91698','43059','35486','89078',
                          '54181','49970','82833','58165','90887',
                          '77628','82978','62931','62816','85458',
                          '33708','34428','25706','15207','15127',
                          '45589','72492','32406','44567','73648',
                          '45827','23340','26339','57344','59362',
                          '79843','20231','50716','76181','44237',
                          '20626','72795','36506','16435','48800',
                          '74712','38465','57404','65475','65810',
                          '67151','74206','41363','46493','16514',
                          '11461','46145','83287','87310','69756',
                          '28713','60600','38249','61027','22416',
                          '33962','45268','36124','83911','12411',
                          '31726','12202','52958','44737','56664',
                          '47587','63962','52838','33307','21502',
                          '60835','51901','36731','60332','93258',
                          '43488','23452','26897','53376')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
