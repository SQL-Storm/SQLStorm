
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '90816','68756','36690','86784','45350','83922',
                          '15484','46554','67511','94960','54437',
                          '48413','18327','27143','74956','36635',
                          '14018','40553','89662','23923','77202',
                          '63296','44440','11731','99295','96453',
                          '77921','72136','20273','10799','22936',
                          '12393','36648','41691','20270','87561',
                          '33514','42843','81272','83440','44081',
                          '25660','30690','36103','77361','73937',
                          '10513','77304','24311','83074','62643',
                          '33918','59072','82367','94803','25151',
                          '52833','28672','38779','34305','21494',
                          '86398','14992','45497','56310','73141',
                          '41144','80847','56688','21497','28082',
                          '27057','51731','38621','88430','30471',
                          '54258','47719','59652','32814','28277',
                          '89435','64966','51915','57551','18043',
                          '42330','63015','18453','38457','14170',
                          '24445','92801','86889','95713','55054',
                          '61739','19285','99999','59091','11833',
                          '54591','22864','99012','54345','22080',
                          '20575','31796','11752','54264','28300',
                          '89049','82123','78113','51667','15708',
                          '58648','96427','89164','19769','40789',
                          '84634','73190','37269','34812','98126',
                          '63825','22739','58236','48239','16907',
                          '86414','48600','62118','31688','77827',
                          '94923','28286','14552','68208','58590',
                          '45952','83497','72944','68205','54589',
                          '97375','58540','17170','32611','50342',
                          '22159','33561','35693','38918','98271',
                          '46047','87747','77197','63149','25049',
                          '15126','75719','50849','90023','44211',
                          '37325','52533','30570','36068','26017',
                          '21495','12601','62612','16111','84357',
                          '33407','37840','23112','44179','40491',
                          '93219','30795','92740','71348','14185',
                          '44140','14727','11717','47459','36934',
                          '50420','23063','30255','51672','56206',
                          '49874','87010','35818','33682','57196',
                          '29225','92702','19752','54124','45460',
                          '16248','15191','60185','20725','75714',
                          '37388','27858','15449','76892','75409',
                          '47938','45314','15150','84918','63118',
                          '61300','22363','37532','36494','29284',
                          '44351','65641','68314','46627','20908',
                          '58871','31724','17396','91614','87262',
                          '16860','19172','96773','87428','15563',
                          '39143','89310','68998','66972','98368',
                          '15564','16770','17040','14349','44451',
                          '82423','76595','96352','44505','72164',
                          '43253','28911','53793','86342','29176',
                          '48195','27245','52823','12699','45871',
                          '82937','56388','21128','80365','39556',
                          '87372','60316','47883','11145','11696',
                          '69836','76983','51611','32058','84189',
                          '15338','43059','43191','73236','67144',
                          '25966','59014','98187','66985','77166',
                          '96085','85922','52540','47968','13498',
                          '80595','10241','63346','25184','56857',
                          '98761','57965','43574','48010','32586',
                          '88707','46303','12360','92140','36678',
                          '18397','17131','50916','42839','61628',
                          '60271','53899','42926','95177','98108',
                          '52871','49252','60923','59808','71581',
                          '50049','50257','54620','24900','14416',
                          '57533','81085','53336','20502','34591',
                          '46268','68981','65921','17480','23408',
                          '71121','96875','38869','99265','51112',
                          '73891','47890','35072','11478','20382',
                          '45880','36222','27948','18115','16889',
                          '63822','71242','32026','53818','74294',
                          '82056','93508','44064','20688','99497',
                          '97862','50815','68881','67371','35638',
                          '48694','44945','92092','53330','49436',
                          '78519','11514','51755','82229','33587',
                          '94306','81701','99926','10499','72679',
                          '55628','51245','44456','49820','82148',
                          '42331','56072','35555','27651','56381',
                          '59595','72626','20329','23143')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
