
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '81819','36266','82472','80022','57652','60223',
                          '87835','44867','49081','18175','10477',
                          '26668','41815','37406','83982','94017',
                          '35393','15869','48518','42844','75260',
                          '48650','66204','79584','98398','16662',
                          '27090','24994','89129','80817','25762',
                          '15730','45619','90205','25619','58902',
                          '62177','55313','71536','43951','18022',
                          '67277','95704','14531','27702','95938',
                          '10071','44723','39628','99806','13350',
                          '39040','77071','99918','24795','86238',
                          '17449','28292','28102','17699','11817',
                          '31364','33387','37493','37484','19184',
                          '10187','58241','12993','20163','32867',
                          '68839','50229','55899','26563','92227',
                          '36741','18102','28182','79370','63304',
                          '84210','17735','25241','67071','10247',
                          '29211','76815','87363','46746','90534',
                          '70157','66336','41807','42855','78978',
                          '52962','76332','38092','19219','23075',
                          '53382','47054','43307','77031','49146',
                          '17366','23096','95934','42273','11113',
                          '34551','34328','29327','44981','65201',
                          '20061','29873','20584','87062','42913',
                          '68275','23648','85232','17152','67672',
                          '91222','89310','29706','10304','39573',
                          '48425','43592','94094','45083','50088',
                          '76166','33449','66629','19960','43559',
                          '44604','41080','41767','58295','50517',
                          '41197','86856','98494','14272','65169',
                          '89123','63065','54745','13228','52154',
                          '36959','52351','80270','82759','10869',
                          '17514','59958','47452','17859','18242',
                          '14754','77509','44673','48806','19087',
                          '61967','32757','37988','13118','51306',
                          '47851','10359','70101','17982','48639',
                          '56399','66609','65375','50237','26195',
                          '11137','85320','32239','50252','49787',
                          '12879','58834','20764','40769','57258',
                          '74914','25407','21191','43008','54392',
                          '81567','86648','10806','99909','43388',
                          '84919','41188','18542','45657','25276',
                          '27390','76350','29809','14817','66041',
                          '23234','69455','18355','24867','49160',
                          '39217','91862','12459','44284','94956',
                          '96674','13236','51456','28942','60640',
                          '56993','49394','49303','32526','79691',
                          '67606','13021','91264','23708','64557',
                          '49491','19279','66508','69687','19352',
                          '68591','50199','38068','66210','45955',
                          '87411','32089','10719','61177','72741',
                          '50145','21107','52601','73051','30690',
                          '26062','39241','78581','45000','63387',
                          '14102','67345','47826','60071','40462',
                          '19243','20671','87943','38379','24684',
                          '97442','70709','30804','11731','10947',
                          '13272','47340','99723','77525','90426',
                          '83064','70462','16240','15386','83126',
                          '64041','12629','49947','50875','79652',
                          '16693','68927','78611','12978','65327',
                          '11919','52884','59029','95700','91632',
                          '81667','65240','58590','57358','20089',
                          '20318','39219','35609','74865','90992',
                          '75877','55987','61304','57177','14649',
                          '67228','12346','99330','96324','44090',
                          '20807','90889','26071','38189','75961',
                          '70929','30448','11329','58232','30132',
                          '87075','52215','62417','13163','10894',
                          '34170','41214','74859','15391','28273',
                          '11116','74643','11001','28242','61492',
                          '20410','54515','44468','36894','69006',
                          '12166','54739','76497','29684','20694',
                          '51639','48931','98110','53074','45439',
                          '83948','15559','50211','79634','68074',
                          '37070','36272','15719','82854','64777',
                          '14099','72061','92193','46194','39976',
                          '59659','72804','82326','96238','90431',
                          '69987','34907','49799','50483','22985',
                          '79674','72073','27324','42789','92490',
                          '39140','59296','95353','16184')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
