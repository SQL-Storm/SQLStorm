
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '93318','72885','62471','49647','50586','21345',
                          '19633','40908','71854','67373','35590',
                          '60303','51539','91043','89962','39890',
                          '18504','62873','37119','31238','53215',
                          '59014','12889','99880','28077','40567',
                          '60150','55222','22631','89619','43663',
                          '69818','95092','10793','40953','45017',
                          '63042','74077','88622','96790','17534',
                          '89213','47912','36462','21893','36598',
                          '45369','30251','86679','52298','11535',
                          '61606','97224','28689','97133','39066',
                          '17058','39760','93898','73527','35713',
                          '93118','76274','67035','23606','40984',
                          '15386','80635','16067','13561','71717',
                          '83544','37914','93506','48748','28766',
                          '84077','49187','45426','87870','61559',
                          '12955','10594','13841','16373','27064',
                          '35602','40384','37288','46768','46563',
                          '63971','45581','73458','54023','73981',
                          '40464','21653','55777','42196','72498',
                          '43287','18878','46763','47585','28957',
                          '33695','18398','29507','91517','11051',
                          '53596','30763','54506','60782','52251',
                          '49668','26148','17253','60930','66619',
                          '61461','91879','46600','33721','54930',
                          '60602','19400','17967','22181','31147',
                          '98665','88193','43484','68362','31306',
                          '70531','84310','43806','57332','70232',
                          '47979','93129','40852','16918','41937',
                          '17237','88839','63961','38416','84504',
                          '47193','75107','69950','31723','38361',
                          '21297','40254','62102','20446','58371',
                          '21080','28807','18968','38527','94938',
                          '28543','42272','46321','58859','39735',
                          '39301','14761','37201','64628','90373',
                          '48544','19812','49851','80413','16512',
                          '42313','53529','32457','76377','64588',
                          '28552','82903','52814','27584','62106',
                          '25742','45321','89118','42851','41230',
                          '49490','32117','74309','64215','11842',
                          '88376','14100','21430','20605','44658',
                          '56325','86991','25067','76695','73873',
                          '29466','19283','13834','49069','52577',
                          '26542','16009','60905','50095','25880',
                          '35329','27721','28032','32461','43326',
                          '82567','20045','38518','41102','65830',
                          '97866','86509','26278','57500','18750',
                          '10481','76369','31771','22363','37763',
                          '50844','16281','61411','28069','11364',
                          '16239','98560','71033','70821','43947',
                          '30730','16042','37946','81694','33881',
                          '47517','95581','45475','23096','43012',
                          '62175','65038','48441','47381','94674',
                          '18010','45101','48146','64043','66952',
                          '13213','40272','98047','55077','26574',
                          '70316','35453','68799','78680','56359',
                          '32768','18740','34344','11569','67322',
                          '62237','18159','34624','67225','78569',
                          '46759','62291','48628','21047','66167',
                          '56555','37422','27767','19307','74295',
                          '39515','80505','15589','24959','88063',
                          '10997','93119','80500','61938','98071',
                          '61110','52675','43945','22476','43923',
                          '15828','72593','16638','56400','10118',
                          '67494','30904','88004','58013','84456',
                          '34836','59210','24060','51171','81948',
                          '47363','72088','61942','82090','81826',
                          '13386','82985','20394','22958','19386',
                          '34043','35487','20710','78610','46984',
                          '61772','66826','42980','99595','48239',
                          '30582','69104','11953','52907','17996',
                          '20721','47529','41938','95220','17756',
                          '62025','45855','72278','40659','36239',
                          '14427','77162','60163','30492','42659',
                          '37137','62023','47690','41423','97788',
                          '45272','14547','93420','96669','73166',
                          '64578','86225','80437','54729','19605',
                          '70612','84429','45303','70907','42472',
                          '36692','77667','36823','47003','72743',
                          '90937','25074','54569','57718')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
