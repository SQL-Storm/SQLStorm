
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '45262','36321','22542','52753','76944','27779',
                          '10654','16216','44947','39973','23250',
                          '85959','50995','12399','78570','57790',
                          '12505','12767','95329','11316','87123',
                          '29093','90523','29569','16272','56687',
                          '88123','77324','38708','36828','57994',
                          '10849','26812','85831','33084','31681',
                          '24800','46301','54907','92922','78796',
                          '77172','12905','19655','52962','94190',
                          '50180','22186','19690','13237','70292',
                          '10456','28701','60817','17112','98658',
                          '36994','29799','20020','41738','65141',
                          '57781','10686','75123','47807','88611',
                          '89837','80036','74759','67031','61071',
                          '86758','22134','16026','28436','10130',
                          '52145','93821','29609','95421','39119',
                          '65353','78901','62844','29079','77004',
                          '77999','47894','12470','60635','20326',
                          '85714','65501','33207','96828','68834',
                          '45518','89479','35253','41141','15064',
                          '67092','49784','72561','38318','20759',
                          '17214','12850','43970','99955','49226',
                          '44333','55268','32199','64025','52965',
                          '98272','12671','61911','27591','26011',
                          '26170','55567','11670','38916','67310',
                          '33204','98442','31471','51771','13072',
                          '10337','78321','18957','76297','16422',
                          '77418','32078','76823','85904','47739',
                          '59327','30689','18534','13205','63341',
                          '55084','16907','99121','75316','49117',
                          '36368','59276','76572','26452','31907',
                          '26329','41097','19083','79563','72119',
                          '14976','36763','45796','74291','50970',
                          '70267','14519','98752','53065','51643',
                          '28221','38091','57683','22391','22814',
                          '98706','79702','58514','79597','65965',
                          '96136','90719','29118','28860','63082',
                          '17379','83655','28945','24729','11758',
                          '10799','59345','26442','13861','95328',
                          '48331','58350','61700','54369','95939',
                          '57263','23429','43584','18187','55843',
                          '20157','75004','17505','30992','23065',
                          '39036','67637','16905','70150','18960',
                          '54212','69011','34451','99492','50980',
                          '13376','25502','74054','44957','17973',
                          '55425','10460','52406','42323','53067',
                          '81501','59951','51385','58000','39531',
                          '16158','81322','51070','67317','89959',
                          '39735','26750','63726','44306','68221',
                          '70340','50010','80719','89246','10426',
                          '57606','76325','62016','50253','21147',
                          '21089','75011','89646','92750','60342',
                          '90093','83462','75436','82730','87581',
                          '51736','44775','16330','17086','51809',
                          '83120','98856','27189','10789','58400',
                          '15032','15218','10959','74687','81655',
                          '47459','59169','27069','96276','15198',
                          '21496','12058','60526','54430','93535',
                          '51245','80423','10603','23542','27126',
                          '84747','40542','73989','42182','95240',
                          '12125','46961','70628','11956','65158',
                          '15416','16610','30015','60321','41474',
                          '10530','87465','69820','93833','37746',
                          '29233','35139','59002','45065','38670',
                          '20200','43143','54096','61097','21709',
                          '22148','18617','13940','25640','88694',
                          '35398','34135','73761','51744','21399',
                          '11336','21554','45940','97698','53296',
                          '83922','86651','37535','53795','45732',
                          '10063','64610','98871','10965','97119',
                          '17267','79721','72924','77874','57032',
                          '52635','72732','27430','48623','41019',
                          '61470','71838','80645','55204','38045',
                          '57566','85900','66767','29670','75166',
                          '59675','96422','10473','24888','33352',
                          '73048','85246','31030','46586','49930',
                          '10570','72827','80984','65059','39819',
                          '53153','47664','22424','36044','20797',
                          '23720','42748','65221','63332','82419',
                          '70616','69129','41573','46696')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
