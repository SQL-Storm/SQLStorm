
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '60795','12376','20397','41779','15813','16190',
                          '76593','26855','68672','73352','72874',
                          '50808','27509','74904','66664','29775',
                          '61459','50676','17692','51243','35469',
                          '88752','16667','49036','26076','95551',
                          '16553','12710','45898','20363','73062',
                          '23159','11242','75805','10251','23256',
                          '74188','15620','22929','41944','84750',
                          '45705','61094','77559','11193','33048',
                          '11583','83221','49298','79716','27796',
                          '43014','35721','36181','16471','11477',
                          '69948','12860','71608','21030','35608',
                          '26691','49747','84559','31145','16764',
                          '39848','62824','91776','88120','64386',
                          '93004','70102','84233','66280','92766',
                          '96785','48502','21705','77351','80194',
                          '82980','75976','24421','15967','29296',
                          '14335','93617','18319','87052','16909',
                          '14205','10404','85420','53357','71445',
                          '42315','28193','14734','94047','31249',
                          '22992','99783','11516','24112','67376',
                          '91077','92817','50168','19563','82263',
                          '57308','10473','51906','49915','21123',
                          '45439','58556','14004','50681','57560',
                          '78102','40138','71803','63084','38003',
                          '35483','63616','67295','69575','13906',
                          '21545','29457','13335','47436','12431',
                          '79684','73981','18413','14955','74710',
                          '42687','46159','75360','79661','38348',
                          '88352','47084','55774','18027','13953',
                          '46533','41351','61313','24337','85572',
                          '42250','50951','90445','11102','77071',
                          '21822','62786','15257','16538','76747',
                          '77788','15641','12508','69150','19043',
                          '17370','88781','33581','57814','20038',
                          '93539','45780','90959','41453','38491',
                          '25561','21698','57991','41092','75933',
                          '98718','38991','60170','95814','17541',
                          '32599','86230','65060','85872','51406',
                          '59490','51448','38531','28815','10642',
                          '72144','58142','56973','24925','17954',
                          '97916','80301','61388','38923','20289',
                          '63335','57131','99592','14837','34603',
                          '13039','50265','45279','66287','81614',
                          '27293','31676','31836','86800','60529',
                          '47642','49944','27136','78143','56123',
                          '52974','52265','29856','15171','61656',
                          '76657','13940','34247','43382','95854',
                          '73545','78407','15541','45369','11645',
                          '97676','42626','35386','15099','72683',
                          '65450','10468','42880','74657','97533',
                          '46679','42064','49299','94099','87702',
                          '44156','91070','24843','77257','92028',
                          '58548','87379','88520','67042','70549',
                          '96701','78262','31227','23172','34959',
                          '26486','39741','16956','83621','70053',
                          '62912','67942','47201','26823','84483',
                          '37455','36825','76085','32521','51923',
                          '25939','34254','39326','59235','53891',
                          '67963','13193','28401','44801','95970',
                          '34737','36023','30873','35123','11442',
                          '85558','95932','92456','58038','65725',
                          '20516','12131','49228','50499','66570',
                          '11746','49155','22781','19638','29975',
                          '24903','13965','60782','38159','55273',
                          '25478','38331','60212','26599','29873',
                          '17474','37224','22885','38732','95173',
                          '23718','39813','92977','29604','19010',
                          '35824','44096','32226','75022','35623',
                          '50921','20824','61817','22069','35850',
                          '10692','93298','65225','35046','16168',
                          '88921','97162','24008','21365','27401',
                          '31884','62153','21727','88330','86111',
                          '46427','67467','50650','89428','98302',
                          '48730','71351','57772','99130','45788',
                          '39226','62818','38205','69487','36487',
                          '58626','21360','19798','83129','21068',
                          '27106','30852','87439','50420','88137',
                          '95484','91451','30562','38951','12049',
                          '95354','28532','18790','31126')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
