
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '50190','89141','74718','19952','30595','37586',
                          '36042','93257','28236','36788','60751',
                          '60061','83788','13622','84576','64408',
                          '54239','87853','56457','79608','13579',
                          '56489','21325','89401','61787','27006',
                          '45870','13044','56542','50413','43100',
                          '36278','19582','74985','40368','44844',
                          '78285','56088','88854','87523','16005',
                          '83486','43843','36220','15290','19469',
                          '48332','42476','48266','53354','37318',
                          '42042','24483','27967','41483','45420',
                          '99089','32484','77833','91515','27292',
                          '26775','39046','36771','64523','75695',
                          '92437','14609','38315','11451','71229',
                          '14081','53072','56198','66689','31032',
                          '21903','51708','72488','22787','78542',
                          '19092','84747','28577','96525','60010',
                          '85061','75345','23246','33386','40503',
                          '50239','91401','61928','83211','43683',
                          '92881','26001','71563','26348','12570',
                          '56777','53691','21195','57710','20413',
                          '25330','81174','53090','11348','22590',
                          '95667','17692','39571','49132','15110',
                          '98587','15355','46826','73524','12764',
                          '93850','94597','16445','16450','80374',
                          '14021','49319','42280','92177','30192',
                          '81715','42896','29537','51063','68500',
                          '50336','85858','44958','21995','42841',
                          '35515','76288','94440','64338','28683',
                          '75640','97841','68664','55286','86090',
                          '77001','80063','97917','26623','16545',
                          '41976','71427','24936','67952','28167',
                          '77039','59890','99331','41702','48856',
                          '11394','36672','38184','13875','10324',
                          '74004','30227','60734','33883','54715',
                          '69935','20539','32724','42284','33292',
                          '86212','21000','24530','42778','34095',
                          '26820','29923','11969','54455','34717',
                          '47580','59699','13250','82552','49676',
                          '76147','94540','24642','18673','32126',
                          '57680','79036','68093','47238','47020',
                          '95654','56475','23675','46459','80216',
                          '29758','97979','11183','21815','60068',
                          '85837','23755','70689','15223','12257',
                          '54228','12426','67246','84447','13196',
                          '50522','65153','42805','35976','40055',
                          '37105','23932','61394','34856','83081',
                          '49666','50467','59910','13704','15015',
                          '60361','79546','51884','19680','31433',
                          '40017','10639','48729','11663','86290',
                          '99741','53920','52977','78901','17422',
                          '64543','98360','30331','95089','17443',
                          '51449','60008','50269','89607','66412',
                          '31820','48325','71084','43647','47092',
                          '79661','20161','21519','58603','92352',
                          '53698','44783','76854','51688','34891',
                          '87391','34936','59156','13261','15453',
                          '82281','42875','67041','55098','66971',
                          '94080','11262','56801','19893','46666',
                          '15427','45247','34367','52221','36098',
                          '71409','30441','66100','66977','59599',
                          '94695','34109','12310','76878','25287',
                          '47014','14581','34830','56473','56326',
                          '26787','41627','17404','34749','77748',
                          '65910','40418','66601','39526','15927',
                          '27638','57065','92491','16929','10758',
                          '22720','50069','27161','37598','78466',
                          '82993','25822','68400','80130','66911',
                          '59391','72234','86309','64243','52018',
                          '45445','50972','18442','11553','59493',
                          '18077','72210','56978','63997','60439',
                          '15959','38677','72237','47140','29193',
                          '22192','44774','52392','25393','19571',
                          '63617','42456','49226','80030','49426',
                          '54017','85405','65662','47877','83442',
                          '84233','12192','76340','85321','35104',
                          '12132','22494','33432','12184','82598',
                          '33889','76300','13606','20812','23632',
                          '69874','45248','62355','27953','61668',
                          '32872','68175','10134','32554')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
