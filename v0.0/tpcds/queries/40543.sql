
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '50022','88345','31748','67313','11409','38134',
                          '58868','26370','55033','46990','72892',
                          '18407','90442','62538','11727','19484',
                          '13780','26196','63119','50918','95863',
                          '85744','49590','18599','12082','77141',
                          '86406','10774','12817','74403','28743',
                          '53977','74018','16994','84864','13147',
                          '20306','47844','64914','65096','39451',
                          '24973','38025','33260','88102','66487',
                          '95069','30385','84151','72698','71504',
                          '74747','27225','70106','49208','32952',
                          '45964','73441','16654','24728','93422',
                          '95115','49715','56331','80417','52297',
                          '44155','60016','47237','34610','22066',
                          '63667','31355','14657','32623','44036',
                          '19475','63531','73764','29450','47439',
                          '11341','83117','42142','20822','71187',
                          '14340','40385','20625','19840','35038',
                          '44061','65973','98209','40659','18713',
                          '33585','16857','43030','88502','11386',
                          '61823','88147','77166','16583','44234',
                          '77746','87753','57468','54244','59366',
                          '16196','67963','58403','90875','12958',
                          '29316','87395','80541','43731','66042',
                          '35065','92849','74258','18008','85787',
                          '61912','46680','18044','16228','52584',
                          '34904','70133','52959','48051','41608',
                          '55090','15703','78860','13734','18384',
                          '28022','90041','21112','14881','16699',
                          '13961','84920','16609','75060','20146',
                          '15422','79258','31465','59304','66273',
                          '80955','33810','67763','86506','85138',
                          '78273','65281','46498','85401','58670',
                          '31919','56999','40544','16590','60448',
                          '31793','68262','93213','86574','47176',
                          '42083','55754','63301','21150','87656',
                          '58040','19420','69037','92632','89024',
                          '11890','52452','11945','31376','38336',
                          '32418','76262','68204','34474','44922',
                          '20882','11293','10494','68754','38645',
                          '82107','19892','85521','50768','34163',
                          '83834','49727','53722','53301','49372',
                          '33861','30093','28163','51847','47497',
                          '50149','58742','73735','67765','51619',
                          '15645','29469','47217','56340','82448',
                          '74066','59145','37836','46617','65729',
                          '83025','22721','52595','28131','71538',
                          '64320','57088','32775','43510','75366',
                          '73257','69768','30866','70195','53052',
                          '39891','73473','93390','46471','80905',
                          '27057','80835','41741','78957','59533',
                          '43643','20208','30363','40391','13066',
                          '75262','67977','33990','64362','86835',
                          '61671','88830','31426','35633','39613',
                          '52192','68289','23704','98744','28750',
                          '36296','35609','20378','55888','19951',
                          '39670','36987','80193','96442','21302',
                          '26589','37861','56491','52491','86956',
                          '16165','94405','77604','12137','21893',
                          '84201','89657','32787','94854','94039',
                          '97554','35975','43571','37052','72169',
                          '46602','77428','98774','41619','20380',
                          '27904','24666','60067','66615','83953',
                          '35094','16193','17393','68633','70801',
                          '18306','21319','37697','26297','51440',
                          '71384','55751','73867','19971','24244',
                          '66038','52758','44424','14911','75664',
                          '18255','29295','21137','35497','13745',
                          '44243','45421','26000','25355','11510',
                          '36486','46304','23417','44096','46662',
                          '90130','28205','80203','64385','50940',
                          '55772','50240','23828','98293','34386',
                          '94821','52103','40362','61100','44044',
                          '68709','55709','47568','49985','64665',
                          '17176','43865','17635','74657','44509',
                          '28938','72251','10268','14274','69507',
                          '35466','60633','63287','16540','84159',
                          '52489','72887','47517','37511','85213',
                          '19156','42204','26461','91745','16757',
                          '78200','11861','73213','51986')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
