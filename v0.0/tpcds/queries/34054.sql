
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '29824','18292','52543','61636','51635','39859',
                          '66381','41648','69727','92707','28915',
                          '85960','80729','21732','80099','75135',
                          '91313','35827','25664','16572','91421',
                          '13088','33181','96262','68288','17309',
                          '12014','88724','93225','30282','84808',
                          '60667','70771','23000','72792','32728',
                          '48421','79217','53883','99977','61002',
                          '90652','92011','97631','17133','62655',
                          '84830','37511','86336','28974','43230',
                          '13693','50842','52366','95953','78900',
                          '11319','92073','70160','93503','59607',
                          '78253','78408','30266','64837','43963',
                          '84309','58345','93001','17816','85219',
                          '61233','47475','48762','33281','23474',
                          '38440','16495','95274','72593','14184',
                          '28892','81785','69217','57897','32009',
                          '89878','91260','51465','93332','95476',
                          '29481','55003','41928','40096','86225',
                          '27908','84079','17875','62887','58964',
                          '38067','73777','94423','43246','48494',
                          '59210','63560','31367','48610','11972',
                          '37620','65550','36904','50955','54926',
                          '19844','49619','49116','75297','82843',
                          '39477','67479','19475','90070','95313',
                          '43562','16845','32431','29117','67309',
                          '83033','24223','65067','70941','26617',
                          '76480','79372','14679','46022','64245',
                          '64551','69495','84728','24894','72906',
                          '47720','95627','37033','83688','98886',
                          '26979','45400','28514','42477','48661',
                          '32849','27095','21110','54494','85981',
                          '18214','12377','28784','34357','85772',
                          '79773','46718','29259','55298','80082',
                          '46158','48718','86053','37235','14614',
                          '64389','37103','94494','43299','77523',
                          '83666','20579','74361','43347','52245',
                          '26395','47076','32741','25860','66176',
                          '59180','52171','79457','36869','61122',
                          '74612','50049','18197','28683','17075',
                          '21422','41532','65592','27104','40751',
                          '18002','18680','62212','29524','12150',
                          '18812','43710','65985','10182','71556',
                          '62020','74745','36374','14617','11822',
                          '14506','16286','59930','95348','70845',
                          '81097','69682','74439','49524','90240',
                          '52322','92886','46545','30751','52389',
                          '73744','97794','31944','11006','41727',
                          '86576','71116','68891','85510','15247',
                          '91295','11800','40646','27310','37604',
                          '96805','93843','48852','98137','16366',
                          '37573','90291','60895','60062','76168',
                          '58100','96604','58893','24716','13623',
                          '30037','30571','31064','66472','93297',
                          '47515','58349','43318','53777','42076',
                          '62736','48262','32208','97004','58615',
                          '93580','13148','56425','61335','40314',
                          '49831','11078','90844','22331','83103',
                          '47879','11802','11773','17541','26085',
                          '39091','21735','53103','41376','84717',
                          '53531','33445','21809','67138','13063',
                          '42073','89078','81109','40572','42802',
                          '91377','75778','13768','69922','91890',
                          '51365','59236','34683','21111','49156',
                          '65493','25486','87270','74684','97997',
                          '80136','83270','26902','17364','87954',
                          '17325','11236','42185','57610','16959',
                          '72343','22453','10481','15179','46588',
                          '24688','54786','13211','44712','18786',
                          '68310','33028','51330','39027','24601',
                          '24164','22333','63563','54161','92856',
                          '14435','66061','16913','32426','25692',
                          '61231','10516','45370','58726','32325',
                          '96360','13290','73539','66831','39017',
                          '36426','31823','44124','13358','69467',
                          '21727','53247','83058','10321','68894',
                          '34941','78798','68483','15400','54011',
                          '29325','66073','84062','33196','49010',
                          '64408','90134','72122','35453','86058',
                          '11999','35578','59341','11623')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
