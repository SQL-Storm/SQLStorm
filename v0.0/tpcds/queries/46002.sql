
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '48387','60637','44064','27997','52243','46012',
                          '27350','49220','98746','56050','38729',
                          '57036','36954','20533','38541','88561',
                          '86594','11819','72539','74034','14188',
                          '69337','92527','18828','33331','22493',
                          '25000','19402','46142','10305','43851',
                          '59038','34770','82316','83638','21735',
                          '17321','92531','65855','68281','64843',
                          '71247','15218','13563','78734','84988',
                          '85548','72006','90296','15602','54036',
                          '19730','25835','14339','66079','49558',
                          '72091','27833','15685','34104','59902',
                          '72861','34510','38970','10810','12190',
                          '25454','73280','60760','65534','69940',
                          '17801','45773','20349','17303','95215',
                          '32247','78536','33567','16529','45281',
                          '64869','53365','99699','43317','86599',
                          '73490','21034','12541','80768','99062',
                          '44101','27838','82321','87449','57685',
                          '76873','13231','85784','25642','96692',
                          '16731','43671','50002','99337','84643',
                          '17869','45076','83373','97213','71928',
                          '85321','96350','67384','91015','10076',
                          '75822','28818','72285','78520','57210',
                          '87430','41933','43718','53478','40690',
                          '68212','14758','79706','77068','74079',
                          '13655','10206','15018','79496','47043',
                          '80069','36450','34075','21586','28365',
                          '97305','11096','37818','81337','91730',
                          '60476','13745','25297','77691','26636',
                          '29747','98417','61793','67124','29544',
                          '98869','71350','78261','46211','43858',
                          '22467','32354','46923','89005','54396',
                          '62726','47952','33256','67940','91720',
                          '45404','22771','82104','74928','97504',
                          '46704','39027','95587','26318','38994',
                          '44801','77596','25412','67576','61245',
                          '76232','21009','25485','48056','99518',
                          '71974','36823','73305','37632','40745',
                          '23950','82383','36008','47369','97780',
                          '96003','56376','61366','66222','64932',
                          '68766','98135','79925','10751','75812',
                          '74195','92931','27091','36356','42360',
                          '18781','88987','51245','27503','92269',
                          '71709','99021','61489','95288','73069',
                          '90448','96805','30030','22407','98937',
                          '95758','20131','70311','74186','71750',
                          '35219','14735','64454','56129','73042',
                          '21515','74397','75516','68727','29339',
                          '43774','36907','20711','79234','11663',
                          '78401','80668','78491','28213','30399',
                          '61869','24533','77057','24313','53013',
                          '43784','18460','49448','36463','41004',
                          '70324','34963','89169','77481','14864',
                          '52188','21635','73445','83807','66360',
                          '74880','92914','15074','31134','34406',
                          '30897','60818','41087','58313','74417',
                          '99261','19262','15580','51038','96706',
                          '42309','56476','29430','20868','39806',
                          '71751','19562','94891','63908','34389',
                          '32030','39741','28638','49148','29641',
                          '95976','86108','98102','13455','25460',
                          '44730','76967','68218','51160','58911',
                          '89931','78862','87621','32254','77967',
                          '59709','27554','23482','19654','23836',
                          '48860','97108','74689','60695','70641',
                          '44019','47365','10128','25516','42771',
                          '46723','42416','48291','63828','65013',
                          '96220','52357','97317','11564','12235',
                          '65358','46071','88043','69691','54974',
                          '55764','32418','22719','25204','29129',
                          '77519','26137','20797','40157','95486',
                          '55663','24045','84248','54072','70636',
                          '86719','40363','31140','28717','81265',
                          '62560','24300','54515','28821','92150',
                          '54685','38224','64076','36244','55071',
                          '88796','46721','19777','62450','84193',
                          '89916','19914','88319','98581','78056',
                          '78808','43081','87833','64704','63229',
                          '70251','47676','43011','11123')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
