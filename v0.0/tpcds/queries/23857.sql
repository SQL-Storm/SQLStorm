
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '19797','20679','47557','30375','13074','32148',
                          '10624','92942','81262','54570','24181',
                          '67394','52917','13956','81421','86702',
                          '64388','23441','48357','65356','30167',
                          '88397','23401','77229','72207','48170',
                          '32003','40695','99874','46133','97175',
                          '90390','10277','25430','16095','53491',
                          '97819','59518','97095','29072','60375',
                          '20668','53208','70932','54690','36359',
                          '85090','25209','53829','35808','93304',
                          '46538','18737','11241','88584','55156',
                          '37089','72687','74928','50141','35586',
                          '76511','11721','98864','28092','30616',
                          '22239','71811','13455','57477','11028',
                          '17893','54901','88110','14533','69836',
                          '54097','18875','79024','62273','72195',
                          '57484','88049','92566','32363','80207',
                          '44941','42635','67251','39170','47941',
                          '31638','27195','10120','14707','30873',
                          '77883','47372','16022','12752','72751',
                          '55318','67184','14116','74363','20822',
                          '77394','56680','29688','61731','16840',
                          '53492','69441','68303','15454','87789',
                          '36870','79654','53744','21995','32089',
                          '17208','66847','96928','37906','38384',
                          '11955','37216','43411','42137','35547',
                          '74145','36037','23312','17707','38147',
                          '97667','36882','59868','12252','37203',
                          '16698','59292','56391','20220','82567',
                          '14133','95802','97906','81359','99617',
                          '58148','75901','18173','28393','65832',
                          '44380','35122','10017','70544','35047',
                          '19827','12738','15620','23997','27710',
                          '11713','16348','48049','89027','68132',
                          '53116','52162','41933','89077','70221',
                          '35416','19073','47826','62340','22943',
                          '60664','45190','47884','19585','25281',
                          '98394','42059','68814','38205','42787',
                          '55841','28986','59427','17880','45285',
                          '88677','58808','61088','61980','90887',
                          '66961','44331','64815','54125','26682',
                          '17668','84455','27332','71333','40972',
                          '44995','49842','17535','33460','91825',
                          '50115','46109','78429','29726','26188',
                          '45691','85017','95674','99881','15468',
                          '36973','80916','53431','33927','23129',
                          '88629','30260','36308','24073','15050',
                          '50322','13783','68668','79267','42928',
                          '52053','64324','16241','39789','40540',
                          '19045','48178','94943','54400','59090',
                          '58866','18147','68456','77167','80531',
                          '52946','85310','23206','76756','42205',
                          '51498','86368','81111','28385','32192',
                          '77659','30467','29510','35491','62501',
                          '12636','25480','23149','43344','79052',
                          '42709','73735','46390','31822','31581',
                          '27583','75044','75610','34342','79802',
                          '21913','57131','15378','29728','98893',
                          '82508','99060','49308','10302','41141',
                          '78606','39034','83403','88486','29636',
                          '80272','47923','84712','14418','66901',
                          '30755','47076','78302','20072','82173',
                          '16609','34247','55238','89126','27690',
                          '63848','39110','39049','39861','29326',
                          '95855','14924','81030','25254','41679',
                          '52595','53640','50426','69755','46619',
                          '65154','59790','12050','87955','72531',
                          '55114','48457','15304','51208','85338',
                          '75910','22425','42034','35158','47069',
                          '24311','22999','64790','45105','19748',
                          '15373','41723','42830','32500','59503',
                          '52522','50054','22258','23333','43665',
                          '34372','88551','43813','77987','57162',
                          '74366','88094','19617','20656','13624',
                          '73640','30643','47639','50989','84917',
                          '88331','15829','40744','99518','12982',
                          '73594','72714','25783','14213','23123',
                          '81624','48673','40435','44329','75884',
                          '14419','51877','76846','56544','34481',
                          '49253','22677','26878','34614')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
