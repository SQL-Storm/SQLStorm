
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '36501','61617','43362','20889','13109','23705',
                          '85228','95128','41954','60669','18803',
                          '42272','84576','89470','89477','38333',
                          '12909','94207','59532','90307','24477',
                          '80773','15676','52522','35812','99615',
                          '60596','75860','55288','26231','85100',
                          '41084','61097','35468','25391','53023',
                          '33589','91556','51476','33499','66721',
                          '60131','79395','53934','13376','95629',
                          '63924','45016','40518','80991','80672',
                          '13666','61834','27527','13994','36836',
                          '39096','73762','55969','78055','83451',
                          '39051','30371','20832','40608','13782',
                          '78492','26593','64886','18939','82751',
                          '47424','49500','44153','81011','13070',
                          '33575','54814','88444','65478','80700',
                          '28100','34590','28646','22799','26244',
                          '30375','53153','62648','48870','85956',
                          '24151','47589','55208','66804','90622',
                          '67260','41746','32429','93448','44210',
                          '61100','23821','41088','35841','16798',
                          '79662','82956','19405','31261','48321',
                          '49525','31446','67600','48783','61073',
                          '98789','13802','26893','39377','72341',
                          '47027','31043','46459','40542','17077',
                          '28119','47970','35760','55325','49222',
                          '27970','84641','36821','14668','36111',
                          '19583','34168','29059','33804','95083',
                          '43145','10852','23640','66710','49616',
                          '35174','36021','23685','12968','78887',
                          '94708','88138','58803','25156','53274',
                          '27399','47072','19698','56476','36950',
                          '35847','26093','23280','11459','89650',
                          '96832','61226','67516','41230','59573',
                          '50940','52456','39700','83605','11920',
                          '13547','80451','21194','34656','12634',
                          '81213','28784','50487','78546','40807',
                          '26710','78119','60804','71096','77161',
                          '64306','85172','36690','20419','71008',
                          '60245','27852','36924','52230','94811',
                          '57972','42552','57196','31784','11884',
                          '70313','16939','63095','32041','39688',
                          '65561','11460','22628','90702','18303',
                          '53920','26547','86826','27701','26607',
                          '64708','15203','73797','28247','65039',
                          '58508','90877','52285','12856','26679',
                          '30086','90791','63007','15748','77434',
                          '14655','55250','32253','48056','11576',
                          '71036','79176','12255','37513','35873',
                          '20921','47182','85695','16713','64872',
                          '46353','11984','40868','67243','35657',
                          '18956','33986','31565','18881','55369',
                          '99489','73133','16987','53428','71352',
                          '15163','12598','75442','24358','50590',
                          '10178','97070','99867','14767','97075',
                          '30091','89856','22340','85946','59920',
                          '11142','95104','90958','26472','52338',
                          '46241','43252','76687','89352','88177',
                          '94026','21703','55545','87799','51640',
                          '56883','55921','27489','50897','95748',
                          '46149','70134','38794','38979','11005',
                          '64389','85566','44155','26117','22013',
                          '20193','84198','60344','98540','40632',
                          '96994','82901','48626','10260','58843',
                          '65750','79203','57767','32564','83271',
                          '14391','82738','12902','36334','34416',
                          '63739','78657','55454','57394','62795',
                          '79064','97982','73822','42448','73021',
                          '13330','57970','16014','37293','78440',
                          '94276','42168','90905','17249','28731',
                          '21495','93209','53402','50041','80671',
                          '16763','49227','44372','20416','18132',
                          '76384','61478','33479','32421','49427',
                          '10444','55904','94471','48867','40836',
                          '53801','87850','12014','83334','22923',
                          '37196','40316','10179','72631','24516',
                          '21863','38311','77854','62863','61185',
                          '24682','56111','14814','18226','18941',
                          '35660','42398','58187','29792','77871',
                          '24158','47697','25668','46365')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
