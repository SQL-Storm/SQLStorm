
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '59850','32397','79704','85064','93494','57523',
                          '17008','11416','88728','15776','65539',
                          '83818','23737','42305','89086','23390',
                          '14919','65754','84453','11938','34315',
                          '42916','31105','16000','26988','29611',
                          '83363','10097','32141','29746','82573',
                          '92999','24491','14914','12173','95760',
                          '99543','42895','12211','25891','40873',
                          '35653','15792','33874','63054','82908',
                          '43306','13373','31014','42572','44779',
                          '62603','48982','19042','45054','74995',
                          '99758','42441','27125','44877','52687',
                          '21053','28414','89227','18575','69463',
                          '92251','92821','38339','78704','20313',
                          '33744','81252','43961','41587','45043',
                          '89927','31853','18202','68847','27190',
                          '27191','64105','71301','28325','21357',
                          '71465','33970','53251','83506','88572',
                          '38811','22466','74970','38400','76939',
                          '39180','94660','24648','73102','26438',
                          '75656','19045','34268','78826','22105',
                          '30243','85932','23153','40757','36018',
                          '21305','70184','11335','63118','45557',
                          '74812','42853','36328','88010','72747',
                          '28645','55244','36663','10723','86790',
                          '24449','74466','18787','26594','81609',
                          '23861','80915','24784','17463','23883',
                          '19083','57279','50069','27883','49780',
                          '48130','72877','22497','43313','43039',
                          '13990','33065','29342','51425','75729',
                          '61463','22231','56341','99805','26507',
                          '50855','31274','72314','45771','74022',
                          '41096','72585','12892','99712','74664',
                          '63464','52062','10862','29279','78560',
                          '52884','16942','56726','67241','77447',
                          '13111','12409','58766','13517','36594',
                          '92761','74242','94467','20525','53594',
                          '48523','73488','44746','73124','23067',
                          '15010','35297','57775','95188','70868',
                          '41119','82546','61647','94859','17162',
                          '38925','80951','63325','69752','19150',
                          '27012','40742','44349','47779','84356',
                          '69344','33157','48391','20197','73777',
                          '47407','75472','64065','80049','61827',
                          '39627','27779','68358','86267','78176',
                          '54484','14501','28860','81151','72055',
                          '15149','96681','93182','31249','31786',
                          '23985','32852','54152','67185','75170',
                          '46722','40891','38137','39363','24211',
                          '50403','42534','13884','68539','93679',
                          '38122','39307','81874','55867','76244',
                          '40134','57174','39117','31520','40483',
                          '48419','62821','28512','61437','29251',
                          '19375','77603','99931','62486','39089',
                          '25392','93916','14432','96036','63632',
                          '56939','87161','19109','29481','67526',
                          '26654','16694','30142','18060','85848',
                          '49495','44012','93864','42306','72172',
                          '65804','20806','43811','20122','22430',
                          '49414','54694','91231','19636','21121',
                          '12341','78775','55053','60362','18525',
                          '20768','69290','93548','98847','31883',
                          '74890','94901','53672','37269','80348',
                          '36944','68962','71021','33217','52928',
                          '56531','37025','45131','11018','22268',
                          '65478','28764','23375','19439','72192',
                          '29305','14801','47651','53090','14449',
                          '36890','21062','26947','56388','32406',
                          '41831','81732','13591','18409','95460',
                          '10987','16280','13850','58407','12155',
                          '29861','78866','17004','71546','90331',
                          '86093','15447','81253','38961','10438',
                          '48667','53100','53598','89779','78780',
                          '56064','20057','29217','62141','42681',
                          '60098','32202','11776','57830','11377',
                          '31414','94083','17270','48214','55185',
                          '49069','82955','50481','64897','62815',
                          '37433','16182','97515','25314','67838',
                          '81779','18288','21920','16040','64135',
                          '29373','28430','59125','35176')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
