
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '53081','21536','29766','70519','59133','10477',
                          '11672','37616','81284','55441','82295',
                          '42790','53526','61653','33532','52288',
                          '99749','32025','71854','51254','45331',
                          '65693','57665','56584','13073','75916',
                          '84881','21569','42974','29606','73039',
                          '78646','18377','86260','24849','54582',
                          '58839','34460','10765','67076','36855',
                          '43349','81117','51803','34662','37473',
                          '16886','17049','62982','65840','29428',
                          '33062','34194','76142','50789','75473',
                          '75644','78547','12714','23352','36688',
                          '98725','14371','49934','71710','73137',
                          '78270','54887','37488','70369','47633',
                          '35708','86780','15883','48592','81814',
                          '21740','45806','52236','13915','83744',
                          '12085','72679','36807','27053','54694',
                          '26946','44394','48578','55784','77352',
                          '73463','78402','59366','49666','37508',
                          '81954','34996','33469','72775','31283',
                          '22965','63592','27126','78131','61806',
                          '60136','43294','57104','70523','62218',
                          '58824','87605','10852','14577','80415',
                          '50943','34267','93818','52762','26915',
                          '13897','91256','23977','68442','39669',
                          '99765','16438','86901','81452','22957',
                          '92804','12571','93279','47992','61592',
                          '78701','94141','64847','11937','55216',
                          '27061','71645','18359','60845','13535',
                          '77635','32941','36770','16417','64929',
                          '85883','31524','27597','23978','19458',
                          '23063','76482','10390','38267','41043',
                          '40009','77991','15768','55596','49300',
                          '99073','16700','84899','42061','63932',
                          '39370','88411','52618','70451','39691',
                          '53607','74983','34121','55928','28575',
                          '62785','11503','73769','91847','10381',
                          '43189','24765','85863','20836','45971',
                          '76157','59997','52151','14187','76722',
                          '49546','17098','32949','40810','32539',
                          '75233','38767','43960','18429','18891',
                          '84501','57581','79350','66606','16871',
                          '73327','80121','23390','15679','47424',
                          '73638','27473','45019','19742','14468',
                          '21989','20103','41849','29328','92313',
                          '25042','21951','14520','14624','94973',
                          '16790','18093','73889','28462','38382',
                          '71323','61876','16604','27156','17784',
                          '74320','98009','23208','50654','61427',
                          '41243','15133','75654','78652','71035',
                          '61566','15008','35688','28022','33702',
                          '30683','39075','68623','26718','16808',
                          '33068','75090','14088','43529','52718',
                          '82320','43486','37663','73625','88225',
                          '10501','24195','95574','88922','30843',
                          '52979','15025','49376','56927','88630',
                          '92507','26913','29624','24446','41599',
                          '35174','23621','10802','72091','29886',
                          '52775','15789','98950','79208','46461',
                          '72386','14436','87206','98912','36124',
                          '49638','34725','74636','56474','43484',
                          '16870','65193','46746','70477','67232',
                          '62261','45316','35446','59828','56034',
                          '67144','14188','19034','98832','62781',
                          '31617','31435','78911','97140','66613',
                          '68123','30531','80695','77843','56477',
                          '53692','48448','85428','95253','12519',
                          '34709','10901','18657','87314','80602',
                          '10579','96026','60949','72783','23225',
                          '40645','69580','38586','50120','24449',
                          '27486','38424','18928','28053','56004',
                          '70104','55792','19619','16173','63550',
                          '68438','71349','93742','41096','49713',
                          '70861','47025','47205','31409','12202',
                          '26057','87441','54566','65233','40706',
                          '11769','32014','19282','43762','47761',
                          '11741','84769','40026','88634','15265',
                          '30115','42464','18754','84289','79171',
                          '44346','79717','79880','73932','31997',
                          '89910','94177','41718','60197')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
