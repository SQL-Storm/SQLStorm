
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '94876','18452','90086','40537','53912','33326',
                          '69802','48572','67243','75012','26511',
                          '26736','40798','72235','32649','15386',
                          '48031','51087','57321','21745','36954',
                          '76961','69289','36992','45132','83514',
                          '33069','45266','33691','21292','20375',
                          '72952','46851','70836','23162','71708',
                          '44480','17575','64162','98268','45016',
                          '91272','94475','24866','18274','88619',
                          '22864','32311','54993','58451','46906',
                          '22139','85228','32267','35777','91176',
                          '77739','82790','77503','53376','79501',
                          '42614','59353','38583','36852','82999',
                          '32548','37963','75423','46690','22326',
                          '30353','33074','25752','20483','76376',
                          '41404','22160','43911','24173','36776',
                          '15287','29179','63079','65910','59582',
                          '27568','34416','49253','23540','94686',
                          '55763','52113','73717','55811','14543',
                          '46786','23329','13141','87492','19337',
                          '38735','16363','66785','44178','39350',
                          '54110','46995','86839','27383','68159',
                          '81247','26690','20672','13418','53089',
                          '56472','23921','96206','27324','31393',
                          '56800','45994','71310','91197','44542',
                          '16681','22647','52412','17741','40399',
                          '78834','27417','91010','66473','78214',
                          '14988','48544','29651','79496','36031',
                          '33316','90532','70113','54477','71865',
                          '88336','85259','45902','65654','19619',
                          '97725','33353','19723','94910','60423',
                          '29070','29039','99219','89145','25026',
                          '43753','97519','30196','26789','34945',
                          '22194','84815','26800','83847','31154',
                          '92051','63823','60341','15227','84624',
                          '95789','31196','57372','29759','19994',
                          '55222','67483','28512','72469','92068',
                          '45460','10307','59509','23420','47767',
                          '95506','17678','77381','82593','87722',
                          '46029','37535','55397','91852','55909',
                          '11654','47160','97475','15660','15200',
                          '25135','89861','25038','17723','96207',
                          '98439','12427','47533','70925','36241',
                          '48044','25207','89704','29539','27482',
                          '26040','10221','82970','29641','71782',
                          '22932','36177','41218','63061','10866',
                          '15678','32277','31280','53613','57257',
                          '79878','82363','38936','55009','44193',
                          '41375','48822','50784','59693','87539',
                          '74861','17459','44045','44408','17589',
                          '40315','81673','61172','69876','82379',
                          '42715','33926','29156','61989','67816',
                          '70396','69157','29925','67765','24867',
                          '26865','59267','83579','89107','45241',
                          '74801','63422','30815','11005','88868',
                          '11908','31868','40074','25076','23786',
                          '13950','52950','98632','74061','56188',
                          '15327','98712','72485','96835','82819',
                          '34789','68781','18971','33371','62321',
                          '30292','75403','48725','70210','45295',
                          '48636','21617','66403','29484','51899',
                          '20955','79753','45548','96580','27508',
                          '91643','46498','71148','19351','33974',
                          '74755','35768','28671','61403','94600',
                          '15681','90085','16228','72932','28432',
                          '43143','75785','14241','65608','76491',
                          '32289','95497','25629','14846','19779',
                          '33350','31155','18147','15060','98234',
                          '87731','88330','58294','12342','22400',
                          '85063','30973','55786','54875','65508',
                          '97130','77617','13688','10635','41779',
                          '46979','63708','89159','13312','34021',
                          '83276','19686','54726','66585','12517',
                          '15805','48606','24200','89259','57224',
                          '55018','44219','74052','27059','74082',
                          '52049','30533','24978','12359','26417',
                          '17949','32146','27458','23597','73863',
                          '78094','83788','25668','46286','14329',
                          '96264','12673','68069','13366','70505',
                          '74047','32147','48160','25733')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
