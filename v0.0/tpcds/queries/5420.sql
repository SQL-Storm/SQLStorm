
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '22750','17511','64285','59532','11685','61424',
                          '40458','37334','45062','16328','67772',
                          '11007','40160','14513','14674','29723',
                          '43510','88207','66317','19150','44695',
                          '68340','37333','91029','44164','78887',
                          '37595','12697','90610','25001','26679',
                          '32208','11072','55082','41681','62069',
                          '17264','95417','27271','54682','10092',
                          '62083','11984','31278','67387','28502',
                          '84127','95104','99793','43718','36895',
                          '72117','14402','55834','19631','49167',
                          '54822','49569','27103','62360','54575',
                          '48865','68694','30722','53397','31341',
                          '76122','70130','27650','19435','26396',
                          '33174','68345','90041','81836','37201',
                          '17669','31411','12843','92791','51532',
                          '10638','18666','99932','47845','43228',
                          '84102','32193','35427','10619','34172',
                          '39298','20339','59491','59364','61135',
                          '39474','90145','57367','24127','38173',
                          '54728','86183','29815','16001','48520',
                          '20591','99080','33159','53581','38770',
                          '89489','38371','56907','23715','98775',
                          '71258','15910','59407','44790','58194',
                          '26316','17676','26842','31605','85108',
                          '89986','66034','52295','10375','25143',
                          '13393','90028','42960','43602','19546',
                          '72149','59492','86617','21037','20271',
                          '14447','69084','96980','16143','23966',
                          '14865','83205','56160','52319','11985',
                          '79483','17721','11580','28132','40824',
                          '27261','49154','81323','94515','36411',
                          '49744','90289','36920','40244','18226',
                          '37195','44383','52728','29547','40432',
                          '21681','10205','88892','51560','97603',
                          '70592','18709','23690','12898','69381',
                          '80409','44242','36126','88991','55900',
                          '98007','96354','15084','77007','34242',
                          '32997','22890','24155','88760','88843',
                          '10388','22960','72661','78551','64432',
                          '28005','63837','69942','25455','36581',
                          '40894','16945','29768','24081','36098',
                          '79261','12297','98929','78157','50335',
                          '24357','32837','80400','81822','41940',
                          '40239','35505','88357','29863','75880',
                          '36062','74085','34485','60160','49677',
                          '42778','42976','74600','88967','95181',
                          '73015','23481','55933','93860','97087',
                          '45882','44187','38259','26125','35744',
                          '36162','43795','75389','69279','17650',
                          '32056','94383','94520','26677','87726',
                          '32451','32263','69186','77570','39155',
                          '62170','80523','36930','10179','28359',
                          '64255','39375','25142','47713','75707',
                          '65307','45557','74117','94087','95278',
                          '32345','92853','39192','72253','79425',
                          '79897','33832','37435','31283','56763',
                          '46041','70509','17242','73349','25768',
                          '18382','82484','45474','18732','29172',
                          '67753','16749','21054','84352','33998',
                          '61858','17215','27242','19372','51120',
                          '85992','44675','34230','11751','20868',
                          '18367','57795','18152','75373','96449',
                          '35545','10129','51937','47570','16764',
                          '74257','67152','45889','53646','64315',
                          '20013','66065','44673','22651','59219',
                          '89308','19326','85965','91841','99556',
                          '18890','41641','56909','40609','80375',
                          '26614','16937','17644','63326','27953',
                          '27576','61433','68485','73762','11210',
                          '48578','82293','44058','38558','90719',
                          '10134','65285','90617','14907','21062',
                          '80006','15404','38736','86620','70430',
                          '86952','14475','89745','50149','13229',
                          '66810','21917','88969','61395','37831',
                          '46141','61839','52298','72567','48282',
                          '49525','70484','35160','18095','31414',
                          '80486','50154','50803','55313','86491',
                          '39774','13294','63032','33850','67436',
                          '10729','79373','50370','14353')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
