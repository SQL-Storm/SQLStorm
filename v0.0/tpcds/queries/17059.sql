
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '14361','93996','31855','12758','73508','72870',
                          '32411','94572','31242','20225','35422',
                          '28877','43629','45125','97415','56476',
                          '56723','21507','74322','13005','78403',
                          '65118','46881','31405','83155','16072',
                          '21372','98664','78542','27900','25119',
                          '81402','91602','32013','17744','97629',
                          '64224','66888','18319','61164','86221',
                          '82436','52998','51015','45654','10428',
                          '93075','32697','43252','58887','16741',
                          '82368','62983','75942','28919','85068',
                          '33904','67026','80281','21233','27486',
                          '53484','38681','89658','29490','53061',
                          '94848','47147','91433','73851','63893',
                          '51787','67005','38646','32331','26010',
                          '47421','29339','49838','25800','50065',
                          '28186','95390','36781','90446','15998',
                          '94081','47686','65692','62351','64342',
                          '55890','73543','82559','90241','72366',
                          '15882','51851','96963','76222','47707',
                          '31068','56275','24285','32611','57568',
                          '21251','22742','66116','19170','48737',
                          '12111','29656','25264','84780','51948',
                          '78625','23986','36219','30112','17051',
                          '94501','33487','62881','47104','38539',
                          '62198','48787','31340','99719','48553',
                          '19324','95635','61689','83028','61867',
                          '73768','48248','10431','65618','33990',
                          '11759','93402','88876','13559','90811',
                          '56496','35085','16805','58158','20720',
                          '27487','26462','16477','34369','20923',
                          '17832','47226','47199','47250','67326',
                          '51982','51756','34541','19559','65012',
                          '13481','23159','30993','98301','92955',
                          '31697','18510','99551','51113','96200',
                          '13983','15622','49898','81830','78674',
                          '22915','43379','67578','47357','52681',
                          '21207','26747','17767','16435','60628',
                          '44855','62462','65842','69456','34727',
                          '24051','22169','16825','12755','37392',
                          '15083','74032','83268','29281','13486',
                          '61756','34123','88194','20252','66375',
                          '19519','24270','67298','60396','50983',
                          '37458','56453','29361','16193','60230',
                          '66481','61422','88991','30006','24284',
                          '14220','85626','41012','15684','60660',
                          '57069','41973','51172','58641','33082',
                          '44283','75431','18352','61494','35984',
                          '20327','79487','32740','98897','55224',
                          '18179','35510','30253','76620','55289',
                          '29594','70778','67071','78619','37457',
                          '68253','46521','61435','58993','37880',
                          '10062','34456','39802','63363','23734',
                          '80736','95357','42016','60837','37735',
                          '71413','21654','20688','12578','34165',
                          '61006','84033','56976','80189','73025',
                          '33008','69733','16135','46088','17069',
                          '12642','66771','31549','27578','51924',
                          '15594','96133','46292','17278','43942',
                          '86722','28056','15750','37802','13696',
                          '57747','87575','69264','60535','13152',
                          '33258','95489','56261','94960','59085',
                          '91281','96465','75646','69811','21243',
                          '90014','77612','14843','20907','34463',
                          '41622','57848','56905','89371','34866',
                          '29999','46712','27698','68707','38575',
                          '14018','14813','28390','37430','79579',
                          '13628','18298','71900','15646','11573',
                          '98450','89421','40885','25507','11803',
                          '20167','11807','61827','13869','17088',
                          '64756','91506','36949','92645','35988',
                          '59561','82540','22972','66163','51768',
                          '42399','69856','13360','96635','64059',
                          '41244','50565','65609','12265','12362',
                          '12253','36428','54533','31466','42556',
                          '96872','47237','70417','15698','18249',
                          '10818','90020','95456','69876','92531',
                          '72021','89663','88208','41082','66397',
                          '36906','26233','56424','63938','22382',
                          '23476','12223','11334','37253')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
