
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '35142','88083','66767','13761','95862','81131',
                          '64752','29638','26278','58424','73052',
                          '73306','25495','70543','16817','80406',
                          '59415','70281','47325','36809','24527',
                          '19145','16326','59039','57435','45531',
                          '52446','92034','47651','43339','14955',
                          '69719','25180','39796','33097','32478',
                          '83591','80156','89256','66594','57826',
                          '19655','53032','21551','41198','12130',
                          '56561','60467','10223','80593','35308',
                          '44358','38424','59395','47490','42205',
                          '63211','14547','24995','96928','86254',
                          '14644','28496','82798','90952','79779',
                          '52231','51925','50388','36922','25953',
                          '79262','28569','27172','20087','89762',
                          '62213','83877','20121','99564','62221',
                          '20764','39045','76001','36690','75649',
                          '21657','34036','51997','93179','26430',
                          '45017','39769','80571','30249','32451',
                          '32020','94204','38563','39949','19771',
                          '43578','50428','39601','26764','87756',
                          '65267','82199','96989','28936','25618',
                          '19807','54051','18600','33763','65812',
                          '16412','96857','44353','27609','61988',
                          '17125','70958','67489','43737','44458',
                          '58731','32455','53902','24563','16615',
                          '73536','64066','90876','50582','60335',
                          '52269','36920','37253','71454','89508',
                          '19652','21666','39406','23140','16625',
                          '98652','18370','66035','83165','12990',
                          '50231','61349','71322','14236','14407',
                          '51014','34205','22033','10419','98476',
                          '53020','37680','53768','57398','36337',
                          '71091','80733','18926','23648','80750',
                          '71046','38647','44714','17997','91873',
                          '47891','21013','14105','42708','30536',
                          '16686','85644','33003','75049','80057',
                          '63137','95089','37744','40815','26429',
                          '98822','96727','79649','72188','53395',
                          '48021','82411','54862','56477','82114',
                          '48394','70594','38373','42802','99194',
                          '22193','29448','71622','94394','86003',
                          '57075','40949','24300','15225','44374',
                          '28004','13476','47652','27037','16958',
                          '38019','12056','77445','76593','39364',
                          '82828','31325','93960','93502','97878',
                          '18776','46537','97322','39823','30338',
                          '25968','52532','22966','32156','49603',
                          '86360','46035','25850','13200','43597',
                          '33997','53414','11437','33469','63680',
                          '49693','97989','10057','48378','11208',
                          '93400','15857','53841','58682','41143',
                          '11165','13360','48721','36354','52224',
                          '89745','18690','44755','91093','39731',
                          '90085','44384','81254','31500','25321',
                          '11964','33890','57148','45410','27551',
                          '62830','58857','16766','32640','79554',
                          '51482','14107','60566','29065','37165',
                          '11005','80972','14511','75104','79099',
                          '13675','88946','61723','93888','71168',
                          '75913','75866','76993','14509','47581',
                          '70775','16053','78282','74555','19244',
                          '46199','67171','82992','93309','22562',
                          '51827','89725','74539','19692','11832',
                          '66235','16501','94733','78245','99697',
                          '96360','33229','98586','46041','10023',
                          '23957','16673','19580','81978','75448',
                          '59829','42186','69947','87273','13847',
                          '89403','14938','98297','38876','30939',
                          '57967','42677','52705','69618','33986',
                          '70038','78953','43010','10880','40364',
                          '62658','37260','41338','51896','84344',
                          '26498','63712','54154','47851','49106',
                          '52661','46051','26058','69400','70598',
                          '73228','34517','46910','39781','30413',
                          '68045','79731','97245','77959','10495',
                          '41878','18293','84478','97514','62895',
                          '46028','34371','74886','52942','23029',
                          '70009','99918','42518','24255','69194',
                          '12052','58225','43876','12364')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1999
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
