
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '86470','49803','41913','11026','73164','29824',
                          '27690','85401','44969','69784','14787',
                          '86592','30601','60877','53166','26514',
                          '45452','75688','42476','10511','71854',
                          '68523','40177','41054','88428','59616',
                          '62348','14712','62925','25871','56964',
                          '89604','17190','14019','99491','23783',
                          '16544','49882','29730','91300','26827',
                          '16860','63215','42389','54214','67546',
                          '84946','73332','63297','99501','85445',
                          '14266','21706','93491','36328','41328',
                          '19533','61552','61491','46865','53533',
                          '22420','41348','87726','94839','23509',
                          '32326','17986','21833','19185','39658',
                          '37406','86865','13028','48020','14010',
                          '79673','11696','22782','79203','54933',
                          '73631','14702','92609','89742','94482',
                          '13579','82575','13952','24637','56406',
                          '12026','26708','30467','59132','77321',
                          '55449','78567','74906','80371','69122',
                          '54569','86723','44102','25666','91765',
                          '69236','70440','71110','91497','19865',
                          '93861','23559','47444','43974','36860',
                          '25544','47192','99976','79331','84293',
                          '60445','13089','30710','37418','68887',
                          '94680','61500','74008','57192','15283',
                          '12551','25481','93950','23546','21440',
                          '58452','92784','48281','92858','35179',
                          '31264','72437','72846','58037','98163',
                          '34444','62052','46541','44033','17714',
                          '39037','66739','73050','25659','87254',
                          '22502','53623','85211','11835','66356',
                          '16800','18369','41948','29053','46957',
                          '99992','79562','23221','48499','39209',
                          '52929','53007','93132','14745','40668',
                          '72454','11838','93154','37054','76671',
                          '84529','42967','56619','10280','17617',
                          '70807','19229','16724','61143','17208',
                          '97530','94688','58395','27948','10497',
                          '60547','84417','80771','30522','14794',
                          '54667','31933','93103','40838','54820',
                          '30244','59111','88379','62484','88182',
                          '30288','89284','29113','30377','92461',
                          '37333','65179','51986','32942','37288',
                          '13105','60654','58255','97168','73950',
                          '13654','42897','46715','43999','46521',
                          '99662','27284','98870','60731','54023',
                          '11666','95324','85220','32108','45148',
                          '38643','77935','45628','59032','25205',
                          '81877','21968','41537','83398','44993',
                          '73766','16254','33503','47721','33455',
                          '66197','66457','77063','97974','24851',
                          '21804','15770','39088','26157','51213',
                          '72457','36279','69893','10801','18179',
                          '12378','96478','25788','32646','61863',
                          '13533','93572','45065','51664','45260',
                          '11486','87476','74035','92617','59845',
                          '71098','58527','35286','19062','91148',
                          '19603','36900','53892','76013','44368',
                          '81386','88083','27902','32597','66619',
                          '55164','12614','68971','36727','79322',
                          '49446','35013','48080','18876','38763',
                          '12303','37677','49861','43077','59737',
                          '27923','94009','49858','23636','75918',
                          '83450','46195','96622','32566','33638',
                          '17677','44254','32550','90096','58045',
                          '12261','19851','46677','20209','28917',
                          '89572','59000','71586','23616','55513',
                          '45303','51291','91303','79883','99227',
                          '17532','65240','44223','48813','30949',
                          '85746','32288','69214','78647','31503',
                          '56351','12824','54373','91769','55829',
                          '18953','35542','40223','59367','54354',
                          '28354','59062','28189','61670','91500',
                          '21261','30822','98322','49037','74289',
                          '62708','53726','19293','41174','77383',
                          '46359','42767','12330','89527','55864',
                          '31915','50620','18645','80416','52326',
                          '18279','90191','89762','51300','61535',
                          '55645','15626','30980','72692')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
