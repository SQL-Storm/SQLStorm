
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '44583','11363','15926','53444','44147','11093',
                          '50792','20097','35646','25291','86951',
                          '96945','60018','64972','50825','79065',
                          '79144','31540','15615','16730','83070',
                          '68144','40035','45582','40852','10526',
                          '29338','23694','92076','72150','57308',
                          '33288','57166','44964','28643','38115',
                          '11557','27550','59186','63309','48929',
                          '57207','58123','45021','46242','32997',
                          '24377','61756','11527','91506','69079',
                          '58566','71191','64335','20328','86067',
                          '20395','10231','62737','82418','39843',
                          '22213','85858','18703','54866','18812',
                          '49926','60688','68548','56112','97160',
                          '24113','41097','61042','16910','56949',
                          '16543','47421','70119','34503','85201',
                          '17566','61945','13318','59303','34683',
                          '59018','49400','82992','41079','23139',
                          '19586','64542','38225','11203','21503',
                          '68796','91504','20980','73759','81554',
                          '14500','87159','40960','10243','45647',
                          '76183','73002','40827','37796','32981',
                          '33487','86626','79277','12215','40889',
                          '89282','94125','58772','28570','21300',
                          '72208','51466','65270','40926','17079',
                          '22464','34108','61706','59475','67303',
                          '24507','21681','35836','88554','42748',
                          '54178','54824','49208','16671','72984',
                          '77663','12457','15135','15106','35116',
                          '45036','78860','18942','73360','73277',
                          '14731','25025','34446','75158','15562',
                          '58166','82534','87187','25580','49978',
                          '14453','20229','77458','31423','67052',
                          '11611','33528','50039','16105','17059',
                          '31838','84475','27893','22957','12578',
                          '45113','46180','38803','70890','31265',
                          '57431','78219','13330','29071','68640',
                          '50266','89362','21588','28008','15171',
                          '52960','89599','58051','88072','39499',
                          '28387','40131','43836','58599','38095',
                          '81365','13411','70625','30634','76319',
                          '32554','29690','75805','26730','80016',
                          '26701','18728','23578','21295','15888',
                          '68362','49479','36897','90837','78395',
                          '23529','72868','84835','20317','65164',
                          '30137','15936','24187','51647','63332',
                          '65886','72359','88526','19853','50613',
                          '11468','60250','93389','52268','36347',
                          '91555','84949','53248','80208','81866',
                          '90881','65269','31308','55410','38572',
                          '52868','33213','21457','48776','25685',
                          '81957','36927','15146','11837','81222',
                          '52361','20926','31143','45225','72404',
                          '49301','20872','86502','39316','82195',
                          '31639','12151','61511','15470','22913',
                          '25273','45441','38960','44042','52911',
                          '22259','55241','78447','85382','24970',
                          '32903','64563','83118','55263','41289',
                          '71374','53146','22277','92974','35336',
                          '16074','60700','52667','77656','69866',
                          '27323','37896','14521','99977','10418',
                          '99997','52287','56221','30202','51706',
                          '11709','26924','29181','74934','94634',
                          '57815','30467','25914','53099','24117',
                          '85795','37740','58429','87997','43605',
                          '33882','76639','25853','16402','18301',
                          '47352','46372','75736','15009','36569',
                          '25550','24355','91855','76593','29108',
                          '19208','53983','40500','48305','38257',
                          '67690','88911','21711','96913','45836',
                          '73454','70718','34688','46870','15427',
                          '16656','65176','86948','48645','92604',
                          '43389','72924','30333','14068','52023',
                          '64135','65463','57045','35247','77589',
                          '69298','32854','89507','48558','13867',
                          '18224','51699','56722','65201','76766',
                          '14096','34284','57894','26918','61925',
                          '98392','51663','46495','73435','99232',
                          '95203','68089','63233','28431','42161',
                          '69567','82608','15547','29323')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
