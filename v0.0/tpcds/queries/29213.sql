
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '52486','34760','31533','50637','34688','13234',
                          '47045','81225','87431','82841','26590',
                          '59976','17249','47827','93570','22380',
                          '27994','13482','59570','40776','50505',
                          '49720','63564','26413','53620','39697',
                          '88616','81111','41665','51539','74699',
                          '86477','93171','70354','75217','78935',
                          '67946','15299','95002','47918','74348',
                          '99628','19944','76594','53179','27729',
                          '85959','79511','14235','10307','34374',
                          '51789','39789','30973','34617','93616',
                          '55708','28490','95137','28286','92480',
                          '15244','68202','57315','27990','25019',
                          '51384','98149','51626','91339','64583',
                          '88825','32178','53587','85492','77629',
                          '27089','87208','20548','83974','17591',
                          '26984','21129','43770','39303','74918',
                          '50460','27769','92140','20399','39396',
                          '18353','17197','73882','86064','84750',
                          '34837','53254','31130','54618','60437',
                          '90552','22386','57073','37883','63813',
                          '82830','10705','78630','85180','13324',
                          '84667','64794','13082','46845','26631',
                          '56300','14745','83290','33059','39347',
                          '77515','49433','76432','60442','15520',
                          '30810','46337','25097','80755','37867',
                          '93229','60805','99908','57866','98309',
                          '41393','50886','67590','72166','57102',
                          '83828','37478','56164','25473','37065',
                          '16507','40943','42193','13596','19720',
                          '57588','43496','98029','86629','35050',
                          '37090','70332','87238','22053','51430',
                          '62124','24726','37636','16193','17955',
                          '65896','12586','10355','56585','53778',
                          '67014','59452','17599','40511','17250',
                          '43080','37188','46117','48556','38831',
                          '63757','78230','42432','77024','55129',
                          '58051','95986','71448','18202','51909',
                          '75242','32286','44751','17962','12684',
                          '74339','36771','46802','62283','32664',
                          '11697','42049','62285','82223','37456',
                          '30509','25850','15991','10378','80646',
                          '22968','71104','20319','78744','61683',
                          '71852','81815','42908','53224','47744',
                          '48371','27782','88337','85981','66365',
                          '76053','96232','74874','22239','63916',
                          '73899','73554','62141','30556','23967',
                          '19325','13899','35674','39977','60593',
                          '17336','32084','70234','34417','57985',
                          '88317','77455','72574','24255','68724',
                          '44346','50930','41560','87913','34382',
                          '26195','35575','42340','20278','87717',
                          '98637','91322','38014','28777','74535',
                          '44312','66915','40849','86172','13512',
                          '56967','44472','69242','69661','40418',
                          '32243','70408','63729','48414','38464',
                          '13707','51715','10744','43527','31470',
                          '20834','27076','85601','52606','99420',
                          '33934','77089','10778','11976','57526',
                          '84537','23273','34752','28236','21559',
                          '93400','96837','52233','84907','27842',
                          '65589','20200','69550','14431','17106',
                          '29639','48558','28546','19218','75034',
                          '29682','25576','53018','14533','13056',
                          '31381','39212','23929','20933','99342',
                          '68451','40839','16041','97464','69228',
                          '37041','12387','48391','31743','73124',
                          '97019','33084','30732','45493','68081',
                          '16618','49485','53169','28684','77840',
                          '52346','51044','63198','19757','15499',
                          '11722','43274','19760','32777','84146',
                          '48451','41281','51270','99104','10955',
                          '21879','39013','14380','93207','40212',
                          '20389','67338','39518','25430','48331',
                          '14625','37673','36990','95966','29672',
                          '50190','29330','32518','54574','64602',
                          '68519','59162','24235','78605','27068',
                          '59432','75668','22844','41300','29365',
                          '34086','45885','46464','57824','75456',
                          '13145','18474','44237','44079')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
