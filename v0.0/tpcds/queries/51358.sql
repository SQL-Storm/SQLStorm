
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '11632','41580','31325','68576','57483','26322',
                          '30000','15300','31820','15312','16166',
                          '56448','95352','20098','36868','58458',
                          '16999','96190','33984','67867','50821',
                          '46801','15433','26564','63016','97291',
                          '34628','40496','83129','31470','58633',
                          '42827','12079','30631','87012','79255',
                          '30305','20421','36092','18748','84914',
                          '50765','59329','88577','66913','64403',
                          '75103','94019','27801','64061','20041',
                          '34405','43305','33694','87134','29372',
                          '54752','92360','18151','30846','15912',
                          '49669','95680','65292','78217','22813',
                          '11606','71562','63989','62195','30103',
                          '81011','32386','41796','13402','17615',
                          '39494','21281','74267','61458','80957',
                          '69432','92948','70041','25375','96082',
                          '34477','23893','14049','22585','18126',
                          '56723','91303','20588','64396','22665',
                          '21727','52588','29195','52439','48073',
                          '66636','36869','62290','24617','83990',
                          '31651','71685','46689','80928','90283',
                          '63688','77301','56252','71079','67162',
                          '83009','26133','37673','23519','25520',
                          '57737','45837','13713','76879','78894',
                          '77695','95351','87000','98226','86347',
                          '38248','73054','53350','71955','54666',
                          '77941','72835','41730','50696','39066',
                          '74151','57092','73816','36394','81146',
                          '70552','19794','36048','52374','44629',
                          '95159','61416','84072','67834','27124',
                          '32661','21867','71203','94119','87719',
                          '72655','35572','11786','49540','16963',
                          '69068','55292','44709','37629','11353',
                          '85583','22068','22084','20001','56568',
                          '40319','48888','50255','91446','82533',
                          '88329','80159','66232','54447','92205',
                          '59413','90809','46775','29880','83158',
                          '31709','76514','80912','11498','65861',
                          '75065','90068','97961','24269','25524',
                          '72738','86213','56701','14023','58649',
                          '31941','59652','83000','87710','25486',
                          '85447','51108','39715','43932','92953',
                          '64372','16576','54771','36345','49980',
                          '48823','73476','20344','63752','17560',
                          '78306','47262','39204','24509','85854',
                          '89534','15938','69307','15443','90960',
                          '68334','10476','87430','19682','62061',
                          '35911','90974','71680','41395','28339',
                          '20960','20331','43580','22118','41544',
                          '63942','56550','73682','82863','47050',
                          '30484','93139','91858','43959','75558',
                          '68408','23415','43425','34541','47609',
                          '27515','94973','11195','52578','32885',
                          '89987','39534','35621','44123','16197',
                          '44163','78756','18604','40587','86050',
                          '82901','20585','12893','10229','55473',
                          '41569','48195','56420','18865','83801',
                          '83735','47507','67444','22542','91280',
                          '52733','24093','97079','52742','30355',
                          '74512','20780','65186','51452','25681',
                          '21066','23776','98115','80633','92986',
                          '26170','17711','68692','19819','45232',
                          '11673','35174','36120','13532','28865',
                          '29637','39156','42014','49188','93845',
                          '66138','84056','22334','31507','55100',
                          '61850','73090','92113','36619','93639',
                          '31461','48390','70988','26706','95401',
                          '75068','70130','48820','10862','90810',
                          '83036','45802','78978','22533','55884',
                          '37889','70606','68663','22402','51331',
                          '79364','83430','10365','26404','17257',
                          '96857','52219','10486','69292','85342',
                          '32742','48603','44513','44212','96754',
                          '29663','78460','15012','84985','20254',
                          '79720','56360','65377','48239','84292',
                          '65551','17163','33691','15185','48742',
                          '34752','34254','74491','50713','73691',
                          '19178','74926','99513','28983','40757',
                          '10335','72954','95696','35331')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
