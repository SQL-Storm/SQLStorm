
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '79052','75822','95513','35977','48662','35795',
                          '27241','16076','24957','12924','72890',
                          '57041','25343','85134','93796','42603',
                          '14245','14791','91005','56013','77505',
                          '48048','53731','54657','71153','25696',
                          '13927','46113','94374','96292','82767',
                          '18305','43187','10031','95714','56124',
                          '28144','15806','11269','44477','29757',
                          '36246','91437','66594','52163','71088',
                          '19434','10127','93243','71927','34863',
                          '36229','47480','53324','39877','33629',
                          '45612','43222','26518','78552','29940',
                          '96441','70958','29668','31649','25908',
                          '13280','94265','84186','12643','99618',
                          '97790','69192','12386','46125','73646',
                          '29079','84397','25683','24432','95924',
                          '88623','35569','26182','92792','41396',
                          '43467','29867','21218','39346','61757',
                          '55723','59033','24227','62636','11177',
                          '19413','76654','83211','54680','21216',
                          '85634','12161','60140','94964','84900',
                          '65899','14229','14216','52133','80565',
                          '40278','31746','32618','72984','58680',
                          '32204','29513','10413','38356','96535',
                          '75572','45236','60161','49374','59198',
                          '12165','50596','81957','52181','28872',
                          '43958','12246','27964','28894','14928',
                          '11941','82127','17204','41603','15717',
                          '73210','46864','97109','56849','15473',
                          '20964','86321','32514','17989','97776',
                          '12799','65352','99974','70488','52093',
                          '95421','63732','70717','72563','40053',
                          '79861','24665','38838','57165','21000',
                          '90081','27628','53636','93428','86980',
                          '60478','18068','48721','47389','96648',
                          '52300','13337','32222','24591','79923',
                          '10062','74231','39039','79182','43247',
                          '41307','69877','61426','23712','25371',
                          '72514','66005','84780','55086','50801',
                          '75209','47793','95417','19654','27147',
                          '17600','10676','72931','42516','20298',
                          '19851','92276','49960','45530','34423',
                          '98975','58389','62376','32313','29797',
                          '79412','69577','16938','23517','40518',
                          '92981','40833','46875','20722','62609',
                          '17714','33428','28886','60236','42879',
                          '97281','88167','23389','25130','30157',
                          '99987','48836','45614','10207','40754',
                          '60620','29014','14994','34607','71860',
                          '84983','33271','29089','34081','88900',
                          '52493','16150','29469','24729','45633',
                          '15682','22627','13047','96451','47070',
                          '95758','25277','86643','24372','11001',
                          '51327','74624','65626','51395','93489',
                          '65639','94799','87148','59200','96816',
                          '69355','57436','19125','75460','41772',
                          '16630','31905','24221','78671','72081',
                          '15700','21816','96911','89880','56475',
                          '91275','74837','14026','55490','11652',
                          '95454','58917','20457','66174','11863',
                          '16082','88073','49162','40469','27104',
                          '80502','29516','24868','24551','44350',
                          '42820','49699','63369','88020','26335',
                          '63545','13826','14603','21174','74195',
                          '48365','30630','11136','24173','51919',
                          '87234','51254','69569','49871','86363',
                          '37123','36942','75387','20166','25230',
                          '29059','93587','63896','29784','32252',
                          '54209','68340','68822','25066','10314',
                          '17852','14715','87302','59416','35870',
                          '72095','99301','69631','27080','31237',
                          '53353','35747','38867','21345','16005',
                          '13271','14698','29570','16666','31975',
                          '18851','70337','19587','14768','10672',
                          '19882','75338','36492','77625','19354',
                          '41566','71154','58236','22584','14038',
                          '48092','33312','73069','10583','52450',
                          '88475','81805','74866','75634','21828',
                          '66491','16148','37733','62726','99434',
                          '92545','22770','20264','78221')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
