
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '50644','23910','42602','39070','90050','25031',
                          '81807','54833','51254','78364','18439',
                          '18317','17418','73146','15029','65262',
                          '28737','35523','20868','55502','39489',
                          '78951','53091','79063','22336','14036',
                          '21406','34746','64391','38050','31304',
                          '26592','25404','17308','26402','70638',
                          '99468','26179','23205','16726','36952',
                          '27836','31285','25104','80223','40690',
                          '24111','83577','81857','63795','87670',
                          '88129','22691','22092','15061','48952',
                          '47444','65789','13123','33464','39571',
                          '48978','49426','83766','74421','11925',
                          '38641','35721','20468','24526','28920',
                          '86259','42817','22628','56252','34664',
                          '45097','42798','53483','38575','12980',
                          '23316','88341','29262','77676','33730',
                          '24834','93648','86598','95548','65533',
                          '37628','97603','43324','24465','17048',
                          '43031','27154','93985','71373','21461',
                          '78768','50646','97700','87635','77933',
                          '19215','50422','15093','50731','48222',
                          '55982','24216','72086','13835','21413',
                          '49738','95347','71923','64153','12523',
                          '20335','24220','70489','14702','38275',
                          '50419','23573','27300','51746','79147',
                          '56841','15111','33013','50888','11974',
                          '19949','66190','49079','19346','53381',
                          '80733','55522','36199','91201','16334',
                          '83888','36042','20262','91064','16208',
                          '97346','10185','22164','35061','20184',
                          '65245','72139','41860','89569','23020',
                          '84177','78352','19833','81923','22265',
                          '23868','29048','76672','68521','86461',
                          '57324','18219','19078','44490','75483',
                          '72147','69348','41814','53420','92548',
                          '84518','31182','58284','91314','70484',
                          '64420','23719','49025','96238','63789',
                          '37531','76163','51285','38827','60885',
                          '88828','28017','18999','88282','23616',
                          '30404','12303','94675','36785','94822',
                          '50550','29533','12446','20774','41182',
                          '40062','84417','92047','82829','39251',
                          '11703','30686','91907','91417','32354',
                          '15092','39386','53834','64867','64102',
                          '21040','15427','53448','56243','22740',
                          '60199','51170','21614','79327','19250',
                          '15223','76412','44126','53606','99110',
                          '77588','17086','30362','13798','22363',
                          '51488','59817','16720','41854','14846',
                          '52522','91169','55292','14865','19497',
                          '10331','67342','30351','24560','14067',
                          '77097','59803','66742','52883','10949',
                          '13717','10535','32287','10409','57429',
                          '55237','13505','88094','59257','46866',
                          '52452','72891','14843','61227','18938',
                          '21367','69326','25325','84786','36693',
                          '73318','43902','14495','84583','33015',
                          '94460','58196','90305','95099','81743',
                          '27815','88807','13516','16340','42721',
                          '25893','99466','49768','80474','67598',
                          '86251','61364','28449','46263','41095',
                          '77899','54996','37412','65215','81834',
                          '17223','43185','57186','54238','98546',
                          '79970','85408','76719','66582','68683',
                          '51795','30064','33945','54660','11370',
                          '34502','76932','72128','28261','63008',
                          '67541','77124','70618','65356','31820',
                          '44913','90291','69719','80149','37611',
                          '59435','68662','27927','93266','83476',
                          '63399','28469','98146','53156','32008',
                          '44165','83944','68469','55833','24457',
                          '54339','63976','35663','38261','31130',
                          '23160','14235','57830','82402','27606',
                          '18411','18134','51267','28684','23381',
                          '93279','27854','16153','32452','87084',
                          '50257','19136','73374','71770','87287',
                          '20237','16142','96637','32279','47134',
                          '68535','42943','12387','96165','50081',
                          '43037','46764','46328','90447')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
