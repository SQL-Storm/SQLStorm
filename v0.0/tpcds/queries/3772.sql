
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '86759','74358','33385','88574','29998','98476',
                          '94040','33746','93653','27883','17628',
                          '69535','55748','11065','83532','15918',
                          '49011','70389','45413','42499','74282',
                          '86210','47913','77995','39744','31925',
                          '17691','15603','69266','52027','55966',
                          '66720','88810','46440','67803','85765',
                          '84372','34570','27837','24657','80303',
                          '30887','27175','20173','47792','65949',
                          '47836','95788','83474','84517','49868',
                          '59810','29507','14638','13040','88274',
                          '67948','25240','70233','19780','15321',
                          '15775','54441','35636','37360','50891',
                          '59277','71636','31826','93981','15722',
                          '64464','36937','57813','83103','55217',
                          '17260','27328','56595','26204','36343',
                          '75866','72226','94271','18784','73518',
                          '67925','56559','16616','37859','17786',
                          '83479','70421','49898','35975','13599',
                          '82090','21341','32080','43228','70613',
                          '69530','38572','68271','51688','50332',
                          '91284','32091','68518','98338','44046',
                          '50729','82330','57797','30529','56013',
                          '73709','64495','35052','67630','14029',
                          '14733','29883','67573','78936','51815',
                          '40937','13676','32295','23951','30867',
                          '80879','51312','35807','16653','92472',
                          '12315','19255','29602','38018','12516',
                          '55104','86908','85331','23367','23280',
                          '74435','63523','56492','83435','52800',
                          '13669','57019','84282','41547','18424',
                          '17875','22948','89359','16071','75306',
                          '27937','60210','10354','95291','43904',
                          '32595','89144','32078','35481','51283',
                          '21077','88101','94193','99889','54932',
                          '94119','39210','30805','23353','42272',
                          '82328','29907','94550','84040','44391',
                          '65371','86333','66945','76657','53132',
                          '53961','25511','46073','24146','46187',
                          '60342','11301','45676','82806','40151',
                          '42673','80401','84347','36672','69358',
                          '10813','60014','22423','28326','78812',
                          '17238','32293','97095','49111','62711',
                          '54329','91772','57952','21618','32868',
                          '56398','43111','55838','40908','87286',
                          '12255','66956','22036','93904','21417',
                          '84806','96062','44670','67154','25969',
                          '52002','61149','39926','90244','86593',
                          '68482','22186','11069','17057','28411',
                          '84247','49301','95910','24104','10416',
                          '31254','81332','37754','28392','40728',
                          '13621','90228','63785','25507','35724',
                          '93988','16948','16018','72881','73422',
                          '30566','46673','65946','51118','18983',
                          '79336','60910','13573','10942','50018',
                          '31899','52356','18612','23114','48473',
                          '39509','64216','89466','34583','68008',
                          '75616','32209','29416','72318','10340',
                          '58573','64600','58743','14393','23565',
                          '97610','59830','11781','11741','44147',
                          '59380','57650','48268','25746','34603',
                          '27062','81327','21122','68048','32744',
                          '74087','90585','66335','42302','93781',
                          '60904','50157','59633','49948','83161',
                          '70191','40532','49492','75862','28475',
                          '89519','41259','65931','33458','98703',
                          '49878','41694','32846','64300','32922',
                          '74502','49108','12329','21696','28377',
                          '55655','46541','98765','41523','48995',
                          '49415','76352','75275','39495','92337',
                          '92732','27025','33945','43218','77116',
                          '99163','99394','81552','93994','44553',
                          '66306','17289','77564','49765','31838',
                          '30799','24583','73153','72351','29485',
                          '13680','34242','10746','80409','62321',
                          '43154','98704','27364','95207','45096',
                          '15599','82678','20025','52477','53409',
                          '36555','79529','99044','58635','97868',
                          '47615','61949','94370','55385','47478',
                          '54503','49860','32125','39045')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
