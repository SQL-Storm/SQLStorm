
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '91329','64979','42117','44055','83578','35422',
                          '19188','10573','71946','82280','31689',
                          '19439','62071','14665','56805','16913',
                          '96680','23369','27677','20996','86221',
                          '34383','45654','20703','88367','38635',
                          '12665','79336','26691','77828','17560',
                          '69809','25954','13662','82293','53815',
                          '72465','20232','14272','90631','50065',
                          '13868','28323','92325','96893','55436',
                          '63234','58900','15882','73360','87156',
                          '56539','63532','55696','14429','57004',
                          '29656','57542','82453','11311','22188',
                          '53509','98422','46653','22237','96327',
                          '22423','20718','50717','86926','45957',
                          '32813','69276','62926','10242','17290',
                          '57987','26309','32049','12499','30435',
                          '62220','95501','18006','47047','35751',
                          '57843','85926','79670','66273','82266',
                          '43379','17298','97063','18891','42411',
                          '62462','75926','31117','72052','42267',
                          '11905','53878','17143','31361','66375',
                          '99763','52778','37458','10684','74369',
                          '38739','37985','87900','44214','20345',
                          '23549','14870','55441','43346','51441',
                          '79487','31912','37239','39852','34829',
                          '96423','55218','42458','59442','37880',
                          '21459','44638','10799','18288','72256',
                          '74311','25948','61006','56976','18819',
                          '10726','24414','12642','30859','12852',
                          '36356','27494','58403','30903','24795',
                          '42677','27644','42979','58071','94802',
                          '10740','70437','21922','68635','34463',
                          '94735','79078','29421','59780','28451',
                          '36475','31138','18524','50141','96454',
                          '82437','35752','19514','36866','71934',
                          '11992','69314','77701','39011','26781',
                          '16458','44228','36952','58553','12362',
                          '53016','18374','58884','79997','52209',
                          '20686','21471','34914','36552','11811',
                          '19792','76524','97130','21924','45402',
                          '58428','23980','47719','60682','27593',
                          '10964','48573','30452','17413','42682',
                          '14760','92197','36029','92383','60895',
                          '68582','99917','16086','33754','62692',
                          '67241','98727','34443','65099','13758',
                          '10926','62892','79206','67723','75187',
                          '21851','98491','19807','88237','63365',
                          '54463','15048','46475','32571','99553',
                          '93262','76415','16144','50068','19071',
                          '14090','60709','91373','40134','49504',
                          '12348','78912','31822','72369','39770',
                          '52735','73154','90868','73186','66615',
                          '18196','80333','97962','89185','21943',
                          '59753','27014','87496','43288','68868',
                          '15701','18580','32176','10762','46997',
                          '64370','11318','15495','59090','74897',
                          '30220','23790','19320','63554','21533',
                          '60064','63907','79556','10871','43957',
                          '48377','53067','10714','34562','92945',
                          '21575','93061','92258','28863','98054',
                          '50507','45731','19980','11086','92375',
                          '19567','97745','78131','18104','46600',
                          '59885','53233','68904','37548','15622',
                          '17070','87116','64262','70642','74859',
                          '30931','75748','30831','76872','52445',
                          '85237','88764','13595','73982','87201',
                          '47810','36445','61019','35019','40697',
                          '59035','93559','91430','42834','71801',
                          '50417','29298','70443','62245','57106',
                          '15084','54617','13442','10370','55236',
                          '79202','62530','21218','41325','19694',
                          '83663','25308','20777','65261','87027',
                          '12051','81752','53504','24153','32594',
                          '45309','19295','75660','86658','49282',
                          '35020','96087','28077','67435','68102',
                          '30954','40930','85209','99673','49239',
                          '47329','28399','94500','21462','34956',
                          '10966','94832','25982','71164','83199',
                          '30871','24800','66994','92518','30878',
                          '52591','18606','40801','87917')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
