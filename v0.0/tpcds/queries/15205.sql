
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '26748','88631','28038','69316','44182','22960',
                          '41979','30798','34793','87882','13624',
                          '80843','20796','66524','21687','91864',
                          '33795','49664','12610','69052','99831',
                          '12566','71640','19120','90041','42057',
                          '87954','12750','31747','57268','13861',
                          '99310','70746','72110','54708','86092',
                          '44433','42790','10404','91259','27167',
                          '83969','42365','94674','49444','53793',
                          '68899','95855','46599','79672','45745',
                          '67662','32567','65577','23962','14843',
                          '27154','31567','49572','64291','67775',
                          '45803','14114','25158','17101','60838',
                          '51979','18795','38382','16869','17880',
                          '11895','20635','85131','97063','86417',
                          '17426','49490','98922','17126','14158',
                          '43099','98003','73158','26446','11534',
                          '72496','33976','62521','87393','60200',
                          '78257','69730','26215','14528','37155',
                          '28573','34301','13209','25630','56589',
                          '80823','40638','31245','15808','51734',
                          '29124','21067','19607','48418','40437',
                          '68728','51842','40244','15348','33108',
                          '97539','47977','81765','97764','11091',
                          '82360','29136','28041','22091','14704',
                          '38458','15049','21596','33605','81105',
                          '43503','27961','81097','42962','20364',
                          '67803','82920','15799','86346','80751',
                          '54967','15087','96512','91779','31765',
                          '16464','59281','35024','33737','13903',
                          '48519','38522','16853','63542','58609',
                          '48472','10357','28683','37154','13927',
                          '10062','71053','14295','27108','54109',
                          '23083','60054','40086','38133','14188',
                          '29127','71460','19195','29062','10975',
                          '94999','36837','35336','79429','71450',
                          '14513','66194','47991','35661','11053',
                          '51481','16121','57798','82979','89497',
                          '12194','84747','76995','66581','86749',
                          '34463','71076','10805','71964','85752',
                          '81155','31792','76076','77828','53119',
                          '77869','79883','31399','49845','28700',
                          '60698','21807','31742','95500','87374',
                          '43541','99317','14722','75428','66597',
                          '51743','75396','17716','70679','38700',
                          '34894','43127','13475','75613','62018',
                          '89372','76923','10574','58481','71629',
                          '12993','87423','53536','44258','16296',
                          '76095','42775','72667','48491','17255',
                          '34884','50237','91241','52919','23176',
                          '33514','82066','88202','86946','49262',
                          '21268','10770','22472','10113','23646',
                          '35139','22631','50346','15844','68208',
                          '16218','20526','91243','83416','29511',
                          '36400','58748','19025','71675','41504',
                          '21209','84058','80809','39568','36718',
                          '52290','93572','31803','95923','75913',
                          '83806','40224','68001','85622','26688',
                          '49468','37370','74636','31374','51256',
                          '44884','16950','43997','32657','55217',
                          '46576','96079','92128','77631','25865',
                          '34775','25305','75309','98331','19421',
                          '49400','83594','49398','38169','39379',
                          '75980','99022','56183','76200','84937',
                          '33991','89961','10022','24770','46597',
                          '74054','53243','44946','22689','29693',
                          '79509','59085','55569','31845','79191',
                          '15212','12371','99167','29064','54674',
                          '38785','86486','78221','92380','93422',
                          '89436','17513','74125','80075','20509',
                          '70925','41134','98471','14194','77258',
                          '16881','43290','30827','13230','92921',
                          '40786','48637','57146','79057','48411',
                          '16175','58229','11668','92831','93641',
                          '62206','49898','12981','23098','45634',
                          '65319','94445','49163','87524','51188',
                          '43579','95210','37152','12611','40808',
                          '72511','55179','19776','30890','11831',
                          '17036','41631','13264','93476','96605',
                          '43228','98496','37235','46031')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
