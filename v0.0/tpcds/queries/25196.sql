
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '25425','62503','26308','25335','63885','19040',
                          '84186','19100','81216','64021','30072',
                          '46216','49342','34560','31152','27151',
                          '36218','76294','41444','86256','81226',
                          '99417','24178','67205','74166','14961',
                          '17427','29919','41910','39058','14038',
                          '39749','66792','75139','79902','96831',
                          '14349','34640','90966','97481','91505',
                          '74175','64950','16669','15307','71348',
                          '37769','75338','62600','83269','28964',
                          '49238','34529','17668','52387','15012',
                          '73851','56761','54012','83479','73039',
                          '21196','26797','16212','25720','21654',
                          '33457','52058','63634','31236','99131',
                          '30324','96758','46585','13817','26345',
                          '92418','74253','27376','65541','95679',
                          '97953','85735','83067','67599','76562',
                          '91873','80742','52013','39768','40305',
                          '24281','88516','52023','48492','65282',
                          '42298','34944','39987','40860','10931',
                          '91512','98998','24821','38807','73768',
                          '41918','35854','18252','11607','17240',
                          '66491','27906','78695','32970','15779',
                          '88540','44722','18875','40968','92827',
                          '33214','71724','39765','44503','99426',
                          '47990','27677','58278','73303','37648',
                          '30649','49777','30591','17321','64141',
                          '45081','61409','10080','17189','23985',
                          '89140','19520','59538','39393','90003',
                          '51904','75844','67124','70692','95028',
                          '56753','71323','15637','59919','93994',
                          '58955','88663','35715','95653','11485',
                          '77083','47974','37737','88192','77861',
                          '44409','33793','87221','35986','83867',
                          '74843','49157','37061','51745','17776',
                          '79905','65307','79134','15711','41282',
                          '87286','35102','49726','55159','57190',
                          '27098','96663','24247','73873','59314',
                          '50634','75100','62904','45934','67001',
                          '45884','30408','76043','51528','11503',
                          '37505','66912','70068','58945','65246',
                          '87705','78809','73081','54506','37243',
                          '41321','90332','92568','73062','11380',
                          '10969','10326','53634','78217','20481',
                          '91842','53593','54091','65061','58385',
                          '37244','22227','59042','53505','72899',
                          '95402','91602','92819','10149','71347',
                          '65684','23190','66940','82095','72846',
                          '94939','46192','48442','72757','33304',
                          '37392','76409','57770','69926','15903',
                          '86235','15462','61732','31793','28461',
                          '10888','57796','94822','34148','20264',
                          '55544','27262','85318','78049','12429',
                          '26448','97033','22548','37649','40211',
                          '70307','93783','26668','51835','60897',
                          '22023','15482','32424','68799','29883',
                          '85996','73695','69001','31231','66645',
                          '77611','73131','36781','61124','20877',
                          '37023','42059','39306','40197','60969',
                          '56719','94848','96690','41618','81073',
                          '10181','15670','25871','75452','13211',
                          '34076','55959','76114','44207','80852',
                          '44210','91778','43722','23086','78131',
                          '69822','95551','64949','90213','64289',
                          '73358','38493','24060','18697','88133',
                          '14304','42379','21129','11942','58182',
                          '37657','49688','93393','19315','66732',
                          '52617','16693','26190','69438','28238',
                          '24131','65606','87063','84009','72158',
                          '71555','20224','25215','47114','12458',
                          '10975','27377','37369','86209','93060',
                          '37567','49594','64991','15468','99170',
                          '12530','37878','56055','25044','10447',
                          '41810','31584','10876','96309','28403',
                          '45826','86164','29695','17373','22228',
                          '57884','30224','67644','10629','15234',
                          '53255','59654','78265','31735','22302',
                          '43646','48353','21411','58975','29028',
                          '11393','65257','43514','95143','19667',
                          '66627','48117','17063','58732')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
