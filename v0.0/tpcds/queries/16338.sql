
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '36501','43362','90073','15445','81416','18739',
                          '84139','41380','36809','59532','68114',
                          '28288','35812','47388','53692','85100',
                          '68036','97104','43975','18502','68347',
                          '90387','19524','30368','43237','36032',
                          '32122','84754','39096','61354','72585',
                          '12478','49798','12936','34012','48583',
                          '66795','92602','86612','72747','80790',
                          '80066','14674','70884','98512','71857',
                          '65085','91107','22083','45496','41930',
                          '57016','74526','17130','98821','65242',
                          '56697','40423','74013','44028','44695',
                          '69526','41206','40612','86632','49222',
                          '84641','12357','39022','42648','46376',
                          '31421','39502','27077','58882','42732',
                          '50043','45266','27399','78371','13035',
                          '60874','64119','97852','67516','10816',
                          '52304','76577','78148','51666','12435',
                          '21203','90917','16613','68482','20175',
                          '28126','26946','62099','36924','61623',
                          '49649','93455','66227','40707','59100',
                          '76520','30070','53920','36984','29161',
                          '68465','35302','14619','57483','22776',
                          '13985','84269','63447','24368','70933',
                          '34270','37513','16587','28760','14136',
                          '11984','94268','39247','44898','61780',
                          '68265','76435','15163','43592','95312',
                          '54224','29608','11477','19809','70943',
                          '14869','17859','23848','27854','17100',
                          '19411','62319','59949','53308','15953',
                          '38447','38408','16540','38672','73601',
                          '61781','70360','56673','38417','33342',
                          '79203','19631','70418','98207','32216',
                          '42506','37865','97172','32486','64889',
                          '13528','23751','94276','66255','28731',
                          '93209','63578','57421','44372','98141',
                          '53931','26630','65874','66971','89953',
                          '50563','89060','37196','37372','62439',
                          '78977','49576','65169','48333','66527',
                          '42398','18566','43889','50945','46754',
                          '75810','34855','16177','30906','11023',
                          '45402','23088','36548','39189','90497',
                          '37781','92787','48585','49604','34084',
                          '12250','84862','25709','90041','89687',
                          '79178','32051','41899','75940','57567',
                          '47821','93393','70230','67982','77431',
                          '16754','35453','92289','22433','20212',
                          '12328','79659','21127','13531','97612',
                          '40350','41412','38188','40584','42718',
                          '22146','37187','14940','26595','39066',
                          '75522','89500','74612','38622','10126',
                          '11214','48547','31041','45414','62408',
                          '82861','41567','13948','34367','96518',
                          '66847','98123','76566','58334','27119',
                          '81622','19337','19094','28612','98538',
                          '34595','95025','57994','46148','15639',
                          '38916','94200','40490','62038','59444',
                          '66845','64947','16971','18291','61527',
                          '72962','21712','43306','48900','48152',
                          '78442','77961','59015','67640','38173',
                          '50790','29470','34184','80718','56064',
                          '19726','35873','80154','69442','84366',
                          '32298','28999','34454','51094','18568',
                          '48946','86644','11408','14816','79422',
                          '18028','97807','74997','93805','48833',
                          '93795','11571','30370','27350','64032',
                          '22622','19695','28238','98536','35134',
                          '20499','50815','83735','36426','71105',
                          '30635','30809','37599','83847','66662',
                          '35289','45202','63087','19893','16097',
                          '14570','46877','15672','15521','86742',
                          '43355','28421','47191','29195','26151',
                          '50836','32563','95316','50996','17641',
                          '30377','65774','73311','63680','27805',
                          '90428','19894','81654','61644','13766',
                          '82072','25483','47718','97204','17196',
                          '35163','22186','22315','45311','80593',
                          '53239','22117','68133','97181','59471',
                          '45869','39945','29754','61720','64572',
                          '27163','25048','27809','47196')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
