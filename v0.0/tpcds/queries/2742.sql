
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '60795','53373','73312','30272','64474','78513',
                          '16079','10323','31541','46694','93891',
                          '41243','10961','13373','55001','84621',
                          '34204','93236','83590','21247','38255',
                          '43829','48957','71437','24608','26243',
                          '88774','64226','31578','28910','26888',
                          '14543','54233','80032','24841','68557',
                          '68451','48820','60835','51682','86657',
                          '36866','46312','31336','76474','77795',
                          '13358','85623','95269','18020','14501',
                          '25138','83615','78639','47219','48649',
                          '54903','72630','83243','42213','26207',
                          '99321','78200','61751','39304','87784',
                          '36753','25989','16558','71484','87452',
                          '42471','91763','91793','81783','79175',
                          '57815','92868','32316','90700','73370',
                          '66032','60445','94880','25191','25884',
                          '93589','39626','29705','44973','57636',
                          '82341','55342','58765','92968','27075',
                          '26850','62649','63658','19955','11535',
                          '17670','75521','44561','89213','12399',
                          '30096','51900','90391','37301','59643',
                          '59278','15915','10353','22655','19091',
                          '30665','85220','16675','55313','59407',
                          '67683','14488','55314','42883','51061',
                          '92819','92902','27501','19172','19393',
                          '52179','60159','85370','59039','99309',
                          '22442','86640','68772','24344','63047',
                          '32713','24405','55270','84908','31967',
                          '20929','51532','60736','88456','14588',
                          '56605','92441','61666','66826','43472',
                          '15038','10921','91205','27539','53414',
                          '72940','13464','25912','14146','60510',
                          '47665','86482','87374','89806','92609',
                          '71106','63899','71861','64124','56206',
                          '86651','28641','62754','79000','29603',
                          '82577','39348','87558','70179','24226',
                          '96141','47819','75425','66150','49773',
                          '14215','89518','72610','98789','67511',
                          '77294','17315','30474','40336','12547',
                          '79364','49726','53083','22262','43100',
                          '98018','29662','42314','90667','22308',
                          '64503','53540','97537','60384','67438',
                          '48926','80047','37101','17575','37119',
                          '43806','16893','76250','61183','91209',
                          '51458','93670','35844','33396','29019',
                          '43868','24890','95052','53882','56985',
                          '77930','97227','95857','95275','49491',
                          '19290','82058','32242','13416','10257',
                          '83219','92336','38959','39167','89214',
                          '60433','49841','34037','15370','77266',
                          '27531','81994','35072','39519','92126',
                          '22027','89450','21263','92141','20170',
                          '46724','63529','30005','63195','18039',
                          '70035','76343','59745','32659','63037',
                          '16853','19328','18619','33857','50945',
                          '33311','28628','83926','38639','62631',
                          '33869','21208','16204','30247','19835',
                          '62870','17413','59717','69948','17554',
                          '14471','28264','90564','20831','79722',
                          '79554','44594','54924','38963','58699',
                          '48826','27147','31849','58026','63144',
                          '19212','26131','47172','18817','38869',
                          '31052','29831','96432','25384','53569',
                          '20434','55974','28333','93890','59202',
                          '72657','93381','68219','43351','65800',
                          '60365','96161','13279','85056','38903',
                          '13068','62161','70329','38082','72224',
                          '56439','74282','12390','42931','29485',
                          '45694','89051','21984','51645','16409',
                          '85193','69574','45171','56150','65622',
                          '92020','35628','81314','55022','48779',
                          '59862','16297','95132','15326','49299',
                          '72117','55488','79007','22904','11486',
                          '86914','51306','67578','25110','60481',
                          '99154','16950','43760','53676','83193',
                          '26242','92216','32530','41369','33056',
                          '22485','96036','46199','51203','40497',
                          '24589','55297','51221','40271','43404',
                          '48256','69135','85068','84966')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
