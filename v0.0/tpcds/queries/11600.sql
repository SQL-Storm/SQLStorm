
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '59672','84815','79660','35168','13494','78519',
                          '21117','32611','71176','64585','12121',
                          '59182','97117','90545','26655','19623',
                          '20367','80355','96728','87503','28093',
                          '36205','19549','40377','59000','93098',
                          '28207','59518','58820','71062','98441',
                          '40909','13998','30323','50247','62671',
                          '96290','45428','76292','22944','72627',
                          '58105','88550','92743','48621','32791',
                          '12596','95748','37107','86784','35017',
                          '99117','40403','50717','52182','20667',
                          '66123','65515','48142','11988','83211',
                          '62581','76457','10506','76094','86786',
                          '61480','61306','10538','65533','90734',
                          '11480','25558','15083','35001','46970',
                          '93837','21207','48959','54803','24146',
                          '47588','40844','24622','49415','76239',
                          '33713','86244','40089','58706','19962',
                          '59101','11495','96039','85694','21240',
                          '63071','15176','41546','63417','58382',
                          '50731','38136','35543','23325','54660',
                          '61053','79640','18966','57787','23159',
                          '89999','72246','76868','81622','47103',
                          '87564','77958','80948','46058','18123',
                          '56967','10427','62429','27962','16122',
                          '33788','38371','38119','45050','63639',
                          '14563','99255','26372','14686','25318',
                          '96965','99257','43958','13925','13676',
                          '96702','69744','28872','60442','11783',
                          '75268','54042','31935','19184','10139',
                          '24264','69305','53088','32687','57652',
                          '90572','87647','79019','75309','69457',
                          '14485','74220','19052','79316','89162',
                          '70420','32206','11616','24235','68829',
                          '20444','72014','40136','49614','28437',
                          '93014','65978','77838','26235','43615',
                          '36154','12919','59611','58367','92471',
                          '39856','88156','73695','22942','76105',
                          '21863','23462','17845','14005','45885',
                          '87562','20654','25806','43751','58008',
                          '66287','95137','11916','18680','18605',
                          '25498','18257','19345','40455','74408',
                          '40259','37209','12630','17171','41464',
                          '46366','33617','54954','89565','80659',
                          '15903','50319','45510','10335','48673',
                          '33241','72670','43217','56541','50121',
                          '93458','90980','55014','44691','37902',
                          '66667','29459','59442','18591','44595',
                          '29232','47208','92045','42870','19129',
                          '52462','92721','39554','61665','54161',
                          '17081','70043','25753','83293','48498',
                          '22063','44742','11534','81424','88533',
                          '97176','19276','62641','39229','97201',
                          '92674','50206','55690','45216','73565',
                          '51684','81415','26901','56596','38888',
                          '29626','97558','53214','25139','29124',
                          '11006','48909','85592','48173','70498',
                          '95012','94980','13695','78927','99119',
                          '54275','32345','79465','20001','33772',
                          '82748','21742','42897','52947','20875',
                          '96274','85531','94909','30093','24854',
                          '90231','73189','32032','35818','62179',
                          '10462','48920','21421','28231','58884',
                          '53067','26029','75612','61293','33147',
                          '41492','90697','56804','72896','14174',
                          '96303','25292','42435','98997','48447',
                          '28508','25028','36073','27924','17604',
                          '12269','44541','39226','71094','17697',
                          '25594','60178','65921','68055','17619',
                          '25878','94439','63869','44643','10092',
                          '29238','19214','14133','57562','47066',
                          '37342','33276','47290','98323','92059',
                          '66638','78774','67666','78444','76569',
                          '38517','97813','39675','88028','43471',
                          '22836','80257','99844','70072','41480',
                          '74966','53927','14058','33142','56148',
                          '44033','29537','58197','25086','46575',
                          '13781','43250','30368','10311','73554',
                          '97133','44441','12337','96915','64073',
                          '85674','78045','99611','89090')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
