
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '98922','36639','15295','40807','35841','57606',
                          '93307','76668','41233','12976','69370',
                          '38004','69893','49944','59060','61206',
                          '18313','91595','35485','61888','21276',
                          '90012','14291','29427','87622','16181',
                          '68785','37414','38825','98243','95160',
                          '41893','52791','75420','83905','25652',
                          '89709','62333','16462','49188','10752',
                          '23858','94813','14088','65840','71323',
                          '82880','67139','59460','37310','33163',
                          '90789','68242','57144','26959','59228',
                          '68452','66570','57571','29574','37109',
                          '94710','30138','24207','13950','54048',
                          '73738','14855','87034','50653','12256',
                          '20868','61408','47507','20177','59516',
                          '89161','77302','68548','55803','76511',
                          '41554','43877','90827','76163','88357',
                          '86836','23536','94169','67123','35664',
                          '28176','24853','38056','28357','52302',
                          '12153','66159','47868','42048','93659',
                          '22160','88467','57634','49657','20341',
                          '18863','60244','31471','11542','95731',
                          '69313','38422','97847','32249','73520',
                          '16533','64281','34754','92698','19350',
                          '92478','33058','23692','73373','11525',
                          '24868','38876','69244','22799','93924',
                          '88092','27366','44625','20463','71273',
                          '81037','58475','73445','46387','57893',
                          '28108','36202','13973','80217','38681',
                          '99276','33041','22488','53965','14489',
                          '62310','23780','74100','50008','22552',
                          '93507','12430','65306','41999','34249',
                          '59997','19456','66293','69361','18502',
                          '67884','10401','10855','18243','84564',
                          '40594','42736','91531','57124','47517',
                          '51250','73355','20968','34114','68886',
                          '13722','77186','69816','67773','77206',
                          '19291','96485','14597','71487','18647',
                          '39441','58183','25685','46885','80441',
                          '95576','74133','23031','67146','70513',
                          '78853','40496','37015','77258','20339',
                          '29655','71314','97864','75696','20003',
                          '83882','91269','13326','94559','25012',
                          '33990','32286','20703','66527','95493',
                          '89573','75218','74575','87198','26854',
                          '23143','67719','71384','21180','64549',
                          '45673','81178','21139','13212','61073',
                          '68742','90940','59133','45194','88344',
                          '64051','10262','51799','66356','35415',
                          '66713','41194','11014','32307','53455',
                          '84992','46529','74195','21968','98728',
                          '48749','30720','11240','78000','77136',
                          '22630','18525','48487','37373','39624',
                          '30493','47416','76192','89022','29293',
                          '14207','58625','30398','98807','13876',
                          '10045','74695','19901','59331','27426',
                          '54396','54889','20742','43734','56934',
                          '20635','58207','33908','67513','85071',
                          '12265','30063','62009','76487','23719',
                          '34376','22479','78356','20604','45954',
                          '75090','21414','18960','97480','31860',
                          '29030','76701','55703','52000','75884',
                          '40851','16451','29615','97112','19325',
                          '24592','33778','17811','15342','23460',
                          '45643','18606','44021','84189','37057',
                          '82497','28638','38781','11381','50121',
                          '93327','34787','33769','34493','38329',
                          '63501','35011','89532','21424','81000',
                          '57300','17840','81880','18179','30372',
                          '44466','53673','27618','29859','57036',
                          '49249','18103','59634','21271','10836',
                          '53005','62506','11026','69032','30024',
                          '73704','71392','96338','14749','37007',
                          '45681','48538','22402','33272','13320',
                          '25370','51722','84845','12518','15551',
                          '22198','28165','17652','69642','88695',
                          '14565','18346','89609','32974','74981',
                          '92733','98580','26911','45078','47363',
                          '56549','21738','71825','45011','68509',
                          '53348','32901','32830','82922')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
