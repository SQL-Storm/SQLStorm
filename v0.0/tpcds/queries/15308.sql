
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '96120','17232','27350','56050','67202','88561',
                          '18097','83074','33331','36998','61172',
                          '28582','19641','41394','29511','73437',
                          '32305','17688','32039','18075','69701',
                          '55029','56429','47186','31564','33174',
                          '79791','29319','23780','86108','19790',
                          '62354','56150','53698','51311','99677',
                          '48200','73271','58619','80750','57210',
                          '96086','96223','34011','31360','27372',
                          '22769','48695','36766','13745','67349',
                          '39888','98869','46211','93115','17124',
                          '51351','78548','45723','98160','68667',
                          '56719','10327','44537','15171','29279',
                          '56426','96003','47367','98135','94754',
                          '18856','39691','27503','67253','66288',
                          '27066','59829','27420','70036','51761',
                          '15713','64289','28002','74714','13358',
                          '91164','53291','80872','12537','59323',
                          '80709','89407','51676','95817','44884',
                          '44279','27972','93677','17055','55965',
                          '94209','11849','21991','12291','32764',
                          '98285','12357','30223','11924','59128',
                          '28474','54652','63828','10335','10076',
                          '61200','42038','22827','26137','21888',
                          '52884','20645','33442','34714','86362',
                          '66720','74041','63236','59656','57125',
                          '52879','55019','18417','12265','13669',
                          '39421','40397','13379','19320','20498',
                          '34867','70504','93400','95645','97244',
                          '50448','34003','93668','58329','70214',
                          '41339','87750','19590','89042','16302',
                          '18771','58333','13923','26360','68515',
                          '84233','15345','52739','26508','54824',
                          '57576','25765','76937','38524','18696',
                          '10309','29596','42192','78917','68945',
                          '27072','36845','96412','12126','23170',
                          '23470','40322','15138','14693','79524',
                          '91181','80818','73089','73398','88553',
                          '22417','91227','10801','90305','77922',
                          '21372','25184','42459','21713','37143',
                          '17508','79441','36880','48721','67027',
                          '42958','97338','13289','81791','89246',
                          '20196','33409','13580','71473','48166',
                          '70810','99732','23749','37132','44855',
                          '13044','65439','93127','37625','33444',
                          '64509','23630','99952','89303','96724',
                          '24569','34839','80533','91396','72118',
                          '97660','30183','88152','10744','47972',
                          '26366','40960','15046','85341','89909',
                          '85586','19427','13571','76546','25140',
                          '75358','73999','46635','82720','64683',
                          '93133','21139','46401','73957','19516',
                          '74356','50716','61422','91920','44789',
                          '98453','74361','85995','28259','69714',
                          '81886','43879','68447','88125','88701',
                          '26103','65521','55495','39313','56893',
                          '31076','45426','25536','81773','89346',
                          '97138','73746','75188','49054','58584',
                          '78988','16548','76507','83044','86028',
                          '58708','83573','67020','10756','57565',
                          '15207','58494','74733','21961','44430',
                          '64424','39304','45504','74709','70269',
                          '48519','90134','42651','57064','22069',
                          '14570','95009','31639','48948','58038',
                          '68572','36628','41794','52014','14046',
                          '36243','86130','42847','92660','38204',
                          '47105','43230','73105','34965','20850',
                          '50124','73615','53342','87006','84415',
                          '36623','82002','28338','70888','90150',
                          '57365','21883','62681','83100','58535',
                          '25353','77184','80280','80382','46377',
                          '14416','30679','73308','23297','27208',
                          '66903','53976','70993','21214','50526',
                          '63456','18004','72812','17833','37611',
                          '46380','72329','73860','84384','55278',
                          '41719','59173','97462','62614','46970',
                          '45265','19157','83014','83629','71858',
                          '23027','76434','22701','27074','92686',
                          '76946','30930','35945','60172','86640',
                          '18440','63745','67506','40375')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
