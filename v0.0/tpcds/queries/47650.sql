
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '41616','81267','95544','14508','77110','13335',
                          '19992','20946','24979','98419','91272',
                          '64027','79652','49394','19433','25646',
                          '72868','75210','69912','44465','57238',
                          '74812','73858','90208','76815','67849',
                          '45362','69059','34139','69079','70536',
                          '92374','51095','23021','43529','53741',
                          '18703','19569','60118','42151','96353',
                          '32680','46139','37886','34047','22533',
                          '26542','57674','16615','38385','71356',
                          '73338','99547','88205','46149','43650',
                          '39385','25380','25502','61319','12583',
                          '48458','48566','24638','49140','86663',
                          '18055','71774','19975','80988','41699',
                          '21714','52693','38456','95814','90938',
                          '30668','98625','75647','17566','50483',
                          '18305','61519','39692','44654','38102',
                          '89667','38211','59354','11426','86758',
                          '94577','37043','60882','97595','98619',
                          '79356','39132','13501','74465','19052',
                          '48455','63156','69857','72971','38417',
                          '22114','72123','39016','26489','50626',
                          '27728','38958','87286','87813','47977',
                          '78180','37867','11824','37999','20421',
                          '49624','32239','84902','22191','63332',
                          '26351','64640','74162','49575','81527',
                          '99119','74550','83844','29233','54656',
                          '76622','88006','78662','54363','96245',
                          '27346','97304','71693','20165','76582',
                          '26609','39356','68185','52928','23269',
                          '90737','43852','85456','79910','34654',
                          '85945','38659','21876','38916','19625',
                          '84712','25919','16336','69322','81356',
                          '15302','37103','36842','82509','37109',
                          '78833','16688','94373','16080','72471',
                          '10902','21575','67395','36069','29225',
                          '17376','14962','84215','90834','12331',
                          '53329','95451','47617','69400','77965',
                          '40585','22477','59551','82794','75885',
                          '90094','43501','11629','38960','46389',
                          '71072','16107','80700','42545','84441',
                          '77525','70571','82703','32068','14309',
                          '36445','88633','28300','65402','21228',
                          '10057','34108','76520','73463','16291',
                          '62926','11413','64128','42010','38630',
                          '16818','84260','52321','73614','32397',
                          '94912','29623','88861','20427','14724',
                          '30988','24251','47482','41273','68733',
                          '21408','91683','59655','31970','89529',
                          '13882','34295','47636','47768','19094',
                          '46700','22295','52787','15870','65713',
                          '93746','14769','72263','34403','49705',
                          '62856','14590','18563','98668','59349',
                          '11576','35265','29189','57121','17779',
                          '10521','77070','69913','35685','31305',
                          '47465','20793','94540','36873','15174',
                          '70154','36787','55596','10945','50075',
                          '15921','34947','98770','40773','45452',
                          '17599','86540','64512','93546','15413',
                          '92375','20263','66603','52393','95774',
                          '85989','37788','52505','26076','71421',
                          '13041','31944','29975','48097','23285',
                          '44249','67425','34346','18552','21137',
                          '70634','99685','54560','86638','73945',
                          '57128','89054','13969','68322','80970',
                          '12099','70245','97470','58671','62067',
                          '26385','36584','26453','64744','92863',
                          '73116','66075','63329','29866','31064',
                          '42383','73112','52566','54079','37220',
                          '48107','88884','13775','58078','12626',
                          '30732','38094','34814','44437','55974',
                          '71953','35872','62767','18429','53208',
                          '23566','12545','10625','90927','65936',
                          '18105','27010','44856','57832','88444',
                          '34600','48694','18831','32423','11357',
                          '16614','63282','23712','71535','34192',
                          '18991','33117','86901','14651','11548',
                          '59642','90519','70974','24788','60912',
                          '40361','70921','86247','48534','10932',
                          '16233','39769','10342','88894')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
