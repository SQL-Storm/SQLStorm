
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '83188','10568','84646','45142','60960','12653',
                          '25917','92517','84576','67727','45208',
                          '68781','12571','91968','16015','88889',
                          '65964','76282','95295','65656','44844',
                          '22947','29329','20828','78543','52059',
                          '24067','52011','53176','17798','73691',
                          '64557','50417','58452','40111','65679',
                          '27828','84335','64750','21431','69683',
                          '13421','54146','63601','63447','66044',
                          '14270','85396','28228','55205','13070',
                          '30075','19882','26301','42663','57891',
                          '85996','50216','97468','57488','85956',
                          '57250','55208','75719','78275','59490',
                          '95358','76870','47123','60443','28501',
                          '10253','23571','30623','49525','85356',
                          '14577','35423','70726','22543','44695',
                          '97662','84231','22431','22687','48712',
                          '55325','98769','45099','61168','89284',
                          '16514','74656','27961','34795','25952',
                          '75722','77669','41273','45361','51426',
                          '55072','51082','40420','19422','44602',
                          '30710','86520','33268','31185','93430',
                          '12580','72039','71923','28478','25000',
                          '57138','75531','71295','59157','56263',
                          '36109','28997','89404','28956','16311',
                          '49962','16487','54012','48677','71008',
                          '85151','66462','16295','64713','68095',
                          '97211','61402','12018','39415','52417',
                          '28120','27272','36846','53920','35596',
                          '94594','45523','35358','11979','94043',
                          '26599','57483','83019','69305','36732',
                          '54838','94715','63548','20727','43240',
                          '38427','22847','15619','62083','77590',
                          '83341','63813','89258','48971','60784',
                          '72076','91684','16187','12465','65229',
                          '23790','81437','77463','96758','73874',
                          '95255','26311','41869','26701','38061',
                          '54280','58022','27154','88059','47876',
                          '38017','79538','32346','88215','61722',
                          '73497','69351','14739','48602','66541',
                          '69864','59584','22920','18899','11591',
                          '57211','86171','76338','33451','40632',
                          '70971','75000','18419','56244','16263',
                          '77444','24051','48558','66419','12568',
                          '72994','19279','80414','44506','47050',
                          '44477','35312','62424','70040','14143',
                          '50798','72123','30606','28377','87074',
                          '26982','62181','22718','50622','11946',
                          '82584','54000','39386','48886','73853',
                          '64456','44973','79022','42830','22923',
                          '95937','83882','38081','43927','63607',
                          '60742','24111','19450','11511','42364',
                          '51383','22089','40423','85861','20248',
                          '90031','43850','79452','10066','99178',
                          '86563','63271','19779','10816','71234',
                          '45493','19851','78227','21852','67759',
                          '38644','84750','29737','28487','69205',
                          '64916','97849','45318','40304','27883',
                          '14033','43152','18140','39072','32371',
                          '54795','72732','75353','10000','50464',
                          '91982','56666','33823','17524','13536',
                          '27203','43553','39522','61269','59451',
                          '77305','37629','42699','20999','26731',
                          '32453','23614','66736','82983','49387',
                          '92470','64958','44901','38796','20884',
                          '33844','60610','82651','12066','54160',
                          '23239','22400','56563','70409','77747',
                          '63810','68655','94343','17163','47779',
                          '74819','13267','44037','49307','83957',
                          '53697','10224','63937','85308','84577',
                          '19336','89627','89961','80689','51066',
                          '84473','42239','75171','19062','58886',
                          '10949','44319','51252','14315','78070',
                          '60511','40603','11852','38487','71693',
                          '47613','20485','16164','23051','21791',
                          '13978','27552','65083','57687','77183',
                          '17909','90992','38344','99161','12006',
                          '82087','92830','47451','17602','45961',
                          '45446','92931','46298','53195','54880',
                          '90766','20773','40098','85359')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
