
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '92239','21241','25967','88394','27350','51347',
                          '69943','66147','43168','70348','88561',
                          '14667','58938','65909','49021','50702',
                          '33331','43702','97760','55120','17532',
                          '15323','19769','33053','19641','54712',
                          '48677','55973','37559','94798','64619',
                          '41048','25990','51412','18531','15706',
                          '66079','36409','81413','82833','16369',
                          '36276','48041','23677','27194','92110',
                          '31558','33044','63531','73110','41050',
                          '91383','19212','22576','29319','20187',
                          '92701','89120','73022','67754','31348',
                          '19790','62354','29293','20341','58579',
                          '55714','18596','81843','52822','44746',
                          '50201','69381','44782','34505','36459',
                          '17883','58158','85768','74625','57210',
                          '13767','60235','37682','17315','23542',
                          '76459','37344','52928','40386','18645',
                          '61996','96973','11513','65028','73258',
                          '15913','16520','13745','24194','97795',
                          '71457','50958','45951','14547','55527',
                          '15610','29149','56798','30585','18255',
                          '15113','99303','89403','63765','32575',
                          '98206','80428','57294','81445','51608',
                          '95841','31289','13104','23588','72723',
                          '33439','99257','68855','74555','20602',
                          '68755','56426','12537','96003','43828',
                          '18642','36574','19804','70619','79549',
                          '75579','10632','80578','19898','18445',
                          '27503','88166','70311','19259','97012',
                          '57195','68287','62230','78083','12820',
                          '70928','23018','23390','36571','21383',
                          '86493','71801','49464','28435','74998',
                          '15151','93184','76487','73400','56041',
                          '13415','44279','25952','12614','74794',
                          '50496','15595','92823','82302','23998',
                          '63201','25112','20275','44149','65400',
                          '31184','82095','48206','59975','77105',
                          '74369','34718','83411','39662','55843',
                          '13638','38619','87339','27678','70638',
                          '25584','52999','40009','23529','91826',
                          '13455','44611','28906','88107','83875',
                          '11710','63170','39148','90233','32067',
                          '34573','15816','18525','16588','86062',
                          '93615','28474','83652','70654','70103',
                          '63828','47958','51236','55523','93447',
                          '36542','20309','67418','82791','21747',
                          '95319','50365','26137','20917','17705',
                          '95214','34478','93979','77034','28954',
                          '30905','42391','17141','27865','22330',
                          '23420','57957','83269','69127','41981',
                          '14078','18026','54369','75307','32418',
                          '13717','11962','13440','17186','48374',
                          '52334','55074','67139','15245','87267',
                          '63771','39421','43246','40397','83754',
                          '49476','37394','37911','35593','83142',
                          '50613','13879','45085','29943','63746',
                          '93400','53844','70345','21522','33944',
                          '59422','36718','23511','15702','80848',
                          '95675','22769','16914','20120','24142',
                          '23697','61718','97252','82542','87169',
                          '35200','58686','65680','20290','34240',
                          '61036','63486','56697','15023','40490',
                          '39383','14844','59630','43818','83194',
                          '43496','44656','28516','15345','58753',
                          '34876','47877','41729','91672','94627',
                          '44443','65491','18165','20555','13860',
                          '17695','49744','69489','61103','18696',
                          '25223','70356','66094','17544','58477',
                          '14642','95659','36168','12221','83814',
                          '71046','87401','28457','28752','80909',
                          '25013','19247','70197','16145','25531',
                          '33805','61899','35472','97264','66658',
                          '33264','32360','51976','70669','30400',
                          '77158','40521','47283','75120','94284',
                          '46202','18345','43850','11769','31306',
                          '62531','79643','70045','93192','59224',
                          '38226','65014','17107','48055','85371',
                          '60802','56641','74884','39684','41251',
                          '80290','27489','31017','70749')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
