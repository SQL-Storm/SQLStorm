
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '17593','49435','58424','11548','47462','40295',
                          '15375','16442','95013','30194','92201',
                          '55654','35765','76705','39538','31054',
                          '42751','42951','29612','50047','35195',
                          '17145','96887','59080','94499','60401',
                          '16635','99254','98153','28037','55500',
                          '99557','56506','20160','31310','96132',
                          '67394','42032','89333','73420','60367',
                          '77663','67353','22827','86645','82108',
                          '70950','39296','98040','59128','58400',
                          '62241','27334','53815','19700','20690',
                          '13430','48570','61061','21915','43325',
                          '71199','86137','10605','73513','27974',
                          '77315','47885','27223','18161','42977',
                          '98449','75167','92015','28269','18178',
                          '48892','32367','85343','15505','26113',
                          '63930','46371','69128','90702','69138',
                          '62100','39472','35203','70471','60447',
                          '73818','38253','43302','87782','89748',
                          '20540','30304','70512','92844','63585',
                          '99616','28302','71668','40487','43037',
                          '24383','20438','78267','80654','10540',
                          '72404','38986','36569','67183','11375',
                          '57257','27150','97138','62380','46523',
                          '64606','47480','32096','74386','31231',
                          '93379','44311','11971','64745','31688',
                          '55523','68348','70948','32532','54175',
                          '42882','83494','70601','44438','25011',
                          '34851','12271','32834','76571','11912',
                          '55737','59905','27957','91594','15140',
                          '94206','10194','39556','24770','47422',
                          '83513','65452','17852','63126','80686',
                          '33813','30448','76432','46641','14802',
                          '66294','18528','18802','33143','86673',
                          '30548','28795','46574','14309','34166',
                          '50437','90766','39154','58932','81133',
                          '82897','35338','25804','48953','25334',
                          '52537','93179','63017','60135','13931',
                          '79465','10960','59926','95331','19282',
                          '22835','96931','41199','78272','34936',
                          '97233','22855','13525','33641','45553',
                          '47768','98626','12410','31941','47535',
                          '40354','94452','22186','31448','69778',
                          '52292','20804','16575','81313','47156',
                          '13831','27152','22569','19022','67469',
                          '79813','13209','33158','63155','69223',
                          '39744','96445','20084','15653','18366',
                          '85058','35897','55228','52197','78751',
                          '58610','28522','91984','82894','50891',
                          '48448','98807','82846','69704','37364',
                          '72918','77060','83553','61911','23718',
                          '57629','28933','11764','25310','70021',
                          '20026','63984','44003','23784','51510',
                          '14047','28547','40636','27854','80428',
                          '67179','48749','21627','69834','10559',
                          '17885','97520','31192','82777','67748',
                          '84583','42012','20718','17796','23531',
                          '26983','55988','22275','26787','14085',
                          '50661','58598','46076','75386','60266',
                          '73518','46879','13394','27369','86551',
                          '27319','75627','42203','67909','12257',
                          '74753','30328','60597','18695','17943',
                          '43289','79790','42425','29609','94464',
                          '42236','64922','48488','54173','50764',
                          '14259','64243','83318','53258','83239',
                          '11485','24343','21182','56269','78822',
                          '61855','30459','14185','37340','43077',
                          '29886','30630','44890','22300','13830',
                          '29784','13130','61572','19023','84204',
                          '82991','57229','34665','89461','60776',
                          '53832','78534','19009','37789','63246',
                          '37041','73152','69476','55313','13906',
                          '41117','83594','57413','88269','55818',
                          '47270','46989','40767','85671','24714',
                          '69808','24691','17575','64502','92148',
                          '14496','58957','29733','28387','18549',
                          '70120','42710','31442','30769','44907',
                          '31727','28019','84567','60998','18020',
                          '53493','35030','76269','24987','74442',
                          '18811','47582','39167','10325')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
