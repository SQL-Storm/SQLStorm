
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '53188','62283','83450','70010','99748','42633',
                          '10764','18177','23848','56477','28504',
                          '79624','29056','29720','20864','78329',
                          '33710','66413','18957','38056','56438',
                          '22980','18021','40338','42269','14407',
                          '32332','37986','88976','70101','19922',
                          '36644','62809','46128','18109','79031',
                          '39707','36374','25053','21476','88587',
                          '83772','51636','73101','55818','43280',
                          '97362','98848','36030','27261','51046',
                          '73587','43305','81161','16421','60008',
                          '92538','23301','42874','40440','12248',
                          '53376','74203','82109','67267','23853',
                          '31474','31976','43744','75219','17854',
                          '55566','36178','98241','17629','39690',
                          '56634','12514','94537','88633','76855',
                          '89926','72521','65951','91545','77305',
                          '17254','42666','28574','83753','34680',
                          '24052','46112','61617','20570','10302',
                          '50786','98837','61150','56349','75690',
                          '17247','67402','76216','32260','40996',
                          '45030','29729','82677','33871','56100',
                          '48098','37150','12615','82081','95034',
                          '82680','14663','32602','52596','69877',
                          '20418','90999','18830','78205','90405',
                          '64850','10680','38909','27076','92691',
                          '57450','93997','90678','15609','77332',
                          '50530','62902','14684','63440','38989',
                          '73750','18017','16153','16088','23093',
                          '37633','58719','43166','11796','27157',
                          '57913','12824','88871','35868','74418',
                          '15683','43244','50212','66878','24657',
                          '75538','28078','48545','48522','11607',
                          '46373','49752','65933','83650','47282',
                          '32018','46621','45733','48597','53831',
                          '30726','42110','71835','70015','84453',
                          '20848','42537','22282','71607','82846',
                          '68079','70275','21178','34647','48456',
                          '75661','60731','23359','30950','87527',
                          '32835','34475','27425','59129','32643',
                          '28232','84058','75279','33745','34255',
                          '54562','88454','59201','45091','44157',
                          '20770','93297','17944','48772','11667',
                          '61394','32817','43151','57115','22410',
                          '28399','68620','29125','46284','64974',
                          '98348','23100','17488','46404','60407',
                          '20775','44031','46520','80689','86893',
                          '55210','89795','71175','75142','14924',
                          '41400','36979','29709','44059','29034',
                          '68567','73660','16894','45144','23828',
                          '75188','45310','51051','28409','76646',
                          '72938','18053','45816','49339','71261',
                          '74340','39756','78345','80406','39611',
                          '58886','12442','81010','31151','22125',
                          '26180','79080','52509','14045','65732',
                          '95276','85784','69917','21894','14691',
                          '80248','50963','27712','15415','68404',
                          '32150','30307','78659','43622','54218',
                          '11310','14293','35102','54486','88114',
                          '96158','29685','60115','21570','14332',
                          '98866','42166','18475','72943','45383',
                          '36930','41962','90172','23998','19053',
                          '36929','20016','18214','61032','60986',
                          '35431','40126','66279','80772','70690',
                          '10966','90718','14465','67269','37677',
                          '75491','60788','45299','40217','22957',
                          '50928','26214','97679','79442','21133',
                          '84811','67294','43694','55095','79332',
                          '46930','30252','73088','18748','45226',
                          '81260','98398','36185','20501','19860',
                          '36531','85906','58149','94000','34978',
                          '65772','47626','10828','12695','49676',
                          '15526','19969','50910','88272','17868',
                          '85196','69134','22522','62292','59906',
                          '40085','91516','95036','26970','59407',
                          '22199','84833','45354','19167','71578',
                          '52711','62293','40925','58746','38145',
                          '73195','44061','83516','73221','38025',
                          '63603','79348','14645','93858','28705',
                          '40637','12130','10344','22893')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
