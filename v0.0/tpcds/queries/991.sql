
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '60795','11625','22338','28772','44354','29964',
                          '96906','32107','69322','91985','41038',
                          '20527','30716','15995','14584','95731',
                          '10328','32126','71795','35508','69069',
                          '80210','52037','46623','21674','79634',
                          '29440','85482','66816','56449','27276',
                          '88250','86856','32582','74505','57195',
                          '87135','79398','52151','77082','63193',
                          '71967','36845','81535','64787','72626',
                          '21601','20166','85318','62201','91110',
                          '35372','60358','83651','64054','67088',
                          '46559','40541','10331','81094','97763',
                          '64635','43598','21599','57725','85564',
                          '32066','25097','10899','26145','55625',
                          '15712','99812','47860','21113','44719',
                          '24794','64065','84464','46059','65155',
                          '28546','21782','94865','40616','15413',
                          '61141','68612','46358','44839','85001',
                          '85369','45554','42173','71004','29264',
                          '36839','13154','58249','84975','60395',
                          '45917','56699','14777','62476','77595',
                          '26990','78728','52763','52639','23904',
                          '90969','53702','12869','12502','54394',
                          '65881','16576','55572','44041','54702',
                          '40698','58604','11489','22507','61039',
                          '63492','12048','31364','96731','71142',
                          '28995','66330','96994','91554','50847',
                          '48876','24652','10448','61274','77327',
                          '85354','20886','26532','26169','16953',
                          '24211','66132','66560','88627','30975',
                          '53497','90473','80173','25361','94829',
                          '85719','43485','91802','12781','16648',
                          '58946','66264','49796','29354','51407',
                          '84931','36871','26888','32938','87791',
                          '28829','43183','99447','68125','86024',
                          '34368','23819','61010','77969','85993',
                          '68518','14078','68115','49897','96930',
                          '27942','70304','44938','58152','48267',
                          '86656','19543','73464','28930','88606',
                          '44817','43957','16028','12463','19059',
                          '17030','59504','10837','36596','90652',
                          '96443','66615','26907','45030','59481',
                          '46383','78754','99559','68390','39359',
                          '35430','47668','59708','74975','22097',
                          '23547','20574','93529','12601','96078',
                          '82885','94280','91436','56364','72273',
                          '70537','51494','39688','26428','19305',
                          '98316','10213','19273','50465','73854',
                          '81559','11517','69783','37069','13797',
                          '17191','45068','59785','85657','61298',
                          '41251','15813','99137','88316','13339',
                          '97787','41242','90925','96408','18300',
                          '30579','84499','27725','75482','70352',
                          '48857','66784','87506','35256','17815',
                          '14861','95160','64545','18588','13485',
                          '56302','30043','31978','14478','24179',
                          '18598','12542','68983','87066','69864',
                          '52783','79642','21408','61810','84153',
                          '19063','60145','30874','32640','31877',
                          '23382','95415','85643','78624','27044',
                          '13477','35822','82659','96155','21635',
                          '93069','73068','33945','43788','81790',
                          '76785','25087','78401','35970','27816',
                          '45680','85283','66103','51669','80521',
                          '98517','29851','13222','21702','18052',
                          '91299','27160','86892','36294','53619',
                          '84079','51716','57924','69054','69655',
                          '82768','66289','64716','74993','36056',
                          '84612','48808','52489','29485','95365',
                          '34510','65261','97251','88450','49043',
                          '65145','88429','83772','96845','42132',
                          '80849','38631','16721','53960','22667',
                          '60291','14022','33592','20064','50584',
                          '40788','21773','50910','44100','27461',
                          '15026','19200','81026','45799','21938',
                          '14715','17218','44104','36698','52181',
                          '34667','95266','96672','52279','66952',
                          '84860','82807','25880','36910','33421',
                          '61215','13345','51197','54931','48947',
                          '99895','74573','73946','10469')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
