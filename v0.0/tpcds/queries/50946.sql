
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '20188','95436','32444','66138','29969','14602',
                          '12447','41692','69461','69033','21371',
                          '55636','99249','47062','69413','42166',
                          '76122','63153','11569','83070','26051',
                          '33711','24487','99662','15177','68994',
                          '28772','62977','37172','11088','94067',
                          '43618','45062','76256','16318','63423',
                          '41266','58507','45570','14948','30725',
                          '12016','30687','59849','34673','51209',
                          '93590','41462','51418','81893','94341',
                          '14337','65003','89649','13979','65990',
                          '23859','17512','95690','40458','59341',
                          '12358','48218','29163','16418','87900',
                          '28545','68762','98352','21896','25400',
                          '24399','92255','63468','69198','18841',
                          '61062','34877','10702','99625','22685',
                          '17467','10808','34389','15959','22400',
                          '32021','79479','53021','86954','34340',
                          '38910','44254','35223','76085','65269',
                          '88736','10332','54184','34766','56478',
                          '86328','28387','39382','50580','35965',
                          '24661','56925','79818','39253','16186',
                          '39527','40370','98875','96831','13301',
                          '24696','14008','99455','38638','41279',
                          '82214','19204','51070','68587','20616',
                          '38852','18080','18753','10134','16627',
                          '31402','21018','98150','89522','63345',
                          '76081','91090','99363','15034','31553',
                          '49727','26705','25669','25841','26480',
                          '54581','17425','57979','80696','53543',
                          '18733','26696','60370','48656','35536',
                          '15225','21076','40413','77452','34433',
                          '28118','84664','69468','10992','42900',
                          '21096','93721','38964','22040','53423',
                          '56245','95054','34859','33840','48482',
                          '58513','40036','27590','22033','70682',
                          '80421','41145','23997','51395','40433',
                          '30075','67370','34889','38276','35740',
                          '96360','48632','99344','28367','39201',
                          '36029','57192','18414','20995','39960',
                          '90166','54066','35721','38924','73993',
                          '30823','92277','24586','26375','64950',
                          '66755','61482','32312','75967','69837',
                          '18942','53201','68462','71746','91047',
                          '28639','74463','72745','12748','41698',
                          '44175','16045','75230','37263','57568',
                          '70093','89363','85369','61516','69508',
                          '17558','54895','43724','25609','86180',
                          '27829','18746','64355','33539','58291',
                          '29006','79476','65667','36157','69585',
                          '45946','97535','76998','29720','73943',
                          '19286','61372','69469','96855','76867',
                          '52418','77928','23648','87307','15730',
                          '69704','39296','70652','11205','15905',
                          '32590','56894','60210','26248','33695',
                          '43624','50198','83284','88392','77093',
                          '40775','16502','51512','72207','70419',
                          '12692','16555','17969','15155','13821',
                          '29562','47872','29574','83884','19012',
                          '76382','63634','42326','69373','65494',
                          '25045','38728','96402','79119','91310',
                          '35802','31717','49838','82577','87803',
                          '21811','16250','84610','93981','26956',
                          '63286','54243','60614','44437','14109',
                          '38191','64290','59519','54376','64562',
                          '57425','13125','55817','19432','70484',
                          '92607','53548','65064','55232','30553',
                          '96146','89891','87830','65503','43120',
                          '13268','88066','10996','67589','40858',
                          '15669','72709','30746','60532','75193',
                          '62706','42029','75961','77192','21275',
                          '83995','15915','64112','75661','64833',
                          '20706','45280','29106','19587','46292',
                          '23449','90304','65935','17080','67035',
                          '75033','12453','33933','21695','16878',
                          '77767','61165','47924','83059','29842',
                          '74002','16743','13041','20376','87147',
                          '86404','39310','35971','63119','57005',
                          '37778','41931','71113','32446','51149',
                          '24640','23787','26784','91101')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
