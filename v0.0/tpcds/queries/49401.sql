
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '40860','55059','64336','20219','83416','65051',
                          '13913','64832','78756','51980','62673',
                          '34948','83806','53125','37335','31584',
                          '53152','50230','85995','99083','41348',
                          '32800','79376','90767','90697','66888',
                          '26359','26443','19655','29828','18281',
                          '81248','52961','71341','43019','11010',
                          '43348','21799','96243','26291','28649',
                          '53185','43505','93055','64920','62214',
                          '67753','41909','41341','80828','80874',
                          '36088','78669','33043','48132','69915',
                          '52669','64871','72148','76723','61402',
                          '37370','77827','10825','65506','30055',
                          '65357','48468','14807','36327','24055',
                          '81333','60465','32961','37279','79761',
                          '42381','31075','52630','14905','18580',
                          '60075','17604','18666','88229','40530',
                          '18212','26820','35428','47463','31628',
                          '36689','20926','96595','11952','82576',
                          '41404','28702','65802','73657','46289',
                          '37516','60831','72519','93946','63221',
                          '82630','73134','64451','50002','11585',
                          '80499','23885','50723','98273','27566',
                          '59047','23512','89878','64390','25820',
                          '50360','78123','77969','70289','35712',
                          '81380','98974','58353','33041','53483',
                          '17388','25582','57297','49329','71082',
                          '15683','76740','50516','85576','18573',
                          '13047','47057','93849','53498','34378',
                          '63410','45017','78315','46404','12958',
                          '11929','74543','22866','31518','86806',
                          '17442','24370','38374','53409','10502',
                          '92446','77774','51682','61114','71373',
                          '44826','92723','18076','54321','25412',
                          '93108','95237','75037','35365','93373',
                          '20070','26991','67709','11356','43448',
                          '74196','15589','46814','36019','55524',
                          '21238','90816','79683','95847','70101',
                          '88255','59686','88575','64188','39043',
                          '47144','75370','56866','36999','50344',
                          '95975','18057','76020','77962','27780',
                          '29807','91830','67608','70335','94087',
                          '64338','11910','26903','71381','35104',
                          '36675','80829','14761','87812','88727',
                          '22519','89801','66535','40130','22388',
                          '62662','49411','41507','42854','19544',
                          '62416','82670','39666','74140','85416',
                          '24759','21410','77386','51866','99687',
                          '50522','15160','35331','48955','44043',
                          '63946','36318','29692','40145','45128',
                          '25943','25802','66297','34436','38711',
                          '77272','32671','22738','82476','79332',
                          '27136','53672','89709','25327','31969',
                          '55254','94855','50861','39900','43843',
                          '68454','98580','78004','14276','24175',
                          '22447','22290','80333','36316','91575',
                          '45286','16482','95541','30539','30183',
                          '43926','28539','23378','22775','24417',
                          '14762','30326','43987','83281','15924',
                          '83703','16544','58818','94612','83133',
                          '22383','77580','54750','97456','65755',
                          '12849','28987','13605','22367','59916',
                          '95282','89228','10757','61609','33402',
                          '56006','60597','12139','29785','43929',
                          '40417','12008','29080','68722','70716',
                          '45077','74650','11938','73141','44385',
                          '20806','12610','67218','90626','14060',
                          '11099','33484','23147','95808','20418',
                          '66507','71679','63220','30081','88629',
                          '33401','71540','35425','44216','18080',
                          '39868','17291','90775','39287','70148',
                          '58163','43275','26273','60623','12565',
                          '28133','75216','29677','44205','73078',
                          '39571','21293','64367','94830','73578',
                          '19319','20368','80534','78488','27097',
                          '15512','38328','38593','47009','48793',
                          '80088','87954','23589','18047','73932',
                          '22292','20101','58395','52223','36497',
                          '31579','66224','34655','33128','59292',
                          '19614','15508','38141','41997')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
