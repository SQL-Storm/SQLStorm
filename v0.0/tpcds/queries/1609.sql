
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '60795','20997','66518','23581','79154','50836',
                          '35747','65374','56720','39344','53792',
                          '93809','90038','32509','23423','75169',
                          '51592','45796','24662','23261','63258',
                          '12338','39988','16682','92431','45895',
                          '23308','75670','42639','56020','88733',
                          '26671','43189','96005','86516','34980',
                          '46089','70848','59126','82544','88564',
                          '53511','40922','54840','57355','25196',
                          '75388','21764','11069','29402','72959',
                          '57197','43428','14979','53446','19219',
                          '27271','58865','33596','41394','40636',
                          '14855','37603','19034','31554','97443',
                          '27305','62255','29914','58552','19945',
                          '90203','63520','45665','61041','92725',
                          '91286','20728','68270','70235','15203',
                          '17836','15984','12581','41600','61409',
                          '57827','91222','47631','13200','22439',
                          '70711','32300','97261','20147','74178',
                          '27863','66287','28935','87278','13130',
                          '68624','42306','45850','64314','22081',
                          '44807','53104','29888','26476','96976',
                          '42408','78652','13156','90446','79156',
                          '24826','33754','50640','91692','53881',
                          '44928','90307','41896','71983','15439',
                          '25639','11394','23648','58769','11096',
                          '39844','17107','17154','54518','71415',
                          '96554','15652','12288','36110','78574',
                          '61107','62897','19919','96508','36506',
                          '86067','50423','89571','68885','28832',
                          '47720','40070','78637','16577','18186',
                          '81378','92907','55819','62182','75812',
                          '19734','72976','36567','10982','81333',
                          '90144','30484','29622','71800','75197',
                          '86590','46623','15917','25917','17719',
                          '37384','32548','19723','19752','19725',
                          '79202','23087','65304','34852','54703',
                          '51022','50294','27359','81779','15956',
                          '79274','54702','15606','79733','86752',
                          '67109','54668','69269','23997','28186',
                          '90826','47623','37677','67103','78091',
                          '98120','65854','24703','31318','62861',
                          '44786','42175','23298','52117','45151',
                          '64048','15856','28923','92168','10842',
                          '14854','44990','27142','22432','25536',
                          '55274','34978','20650','16181','18944',
                          '75303','97858','39931','99347','89456',
                          '69011','19096','72145','17877','86775',
                          '39049','23753','67690','30919','38957',
                          '80581','13145','36926','29459','78393',
                          '61769','41787','52223','23041','31568',
                          '62441','43134','17441','23591','52903',
                          '63497','48690','91695','65853','32706',
                          '67964','61581','62009','79641','79300',
                          '47903','59083','84056','33967','66810',
                          '22787','38874','70641','26636','86093',
                          '46503','69617','41617','92909','23965',
                          '11443','35733','17541','18454','74224',
                          '41393','19502','15262','94030','16291',
                          '63579','87263','56487','50339','79126',
                          '57792','17339','24094','88622','35227',
                          '16169','14015','19263','12885','88199',
                          '82267','40736','49571','89539','16759',
                          '21092','10913','16281','19265','89626',
                          '40928','92162','85884','28746','60782',
                          '87925','38864','16988','87092','83760',
                          '95067','38409','84834','16219','93287',
                          '53497','89521','38468','50808','51689',
                          '25845','17428','24976','18240','23931',
                          '62941','98417','63623','48568','93686',
                          '70988','28094','53030','24222','30493',
                          '10149','38756','64686','96168','10950',
                          '70215','39157','93174','17293','18350',
                          '41183','39604','17364','32182','29929',
                          '72041','16941','44098','33273','41446',
                          '41887','97361','67107','84706','11735',
                          '78721','15897','93827','95962','89624',
                          '23606','97463','80434','14881','86598',
                          '68651','54112','62310','10564','71044',
                          '62466','33161','64747','21278')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
