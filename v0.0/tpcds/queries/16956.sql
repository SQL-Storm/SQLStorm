
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '54050','72111','13786','77496','51927','71509',
                          '96581','48447','83698','47132','68947',
                          '51764','98891','39237','70413','48605',
                          '17288','53483','16441','42870','52329',
                          '58480','13947','79561','70782','55430',
                          '54799','14945','24684','79729','33988',
                          '11152','79098','45886','32295','12050',
                          '69078','71137','49590','47161','33278',
                          '39067','64944','46327','18225','61785',
                          '32980','40707','62571','38225','40307',
                          '97211','25917','99757','36512','33435',
                          '32531','16504','50371','44503','25617',
                          '98036','88008','12517','32447','23364',
                          '36309','70433','51589','43966','90601',
                          '47366','23627','95457','49912','45511',
                          '22786','12887','61246','32218','27357',
                          '10956','25892','73895','97535','22005',
                          '26508','63341','16627','37078','23067',
                          '99726','79301','53017','34931','42778',
                          '46770','24898','22611','89804','23390',
                          '42985','49666','30712','36192','75767',
                          '16085','79350','34300','47244','76163',
                          '53514','33303','13312','61686','19050',
                          '59440','95328','21640','56555','87916',
                          '29106','23449','84832','51496','39304',
                          '62464','74002','76883','63586','64573',
                          '18272','70096','60176','99906','52902',
                          '12896','23953','16949','62812','17185',
                          '36698','34316','63707','68796','48656',
                          '70290','26566','23876','33566','50149',
                          '44045','47167','32845','10519','69804',
                          '67877','63388','43058','60367','19944',
                          '38969','51809','55588','66096','11124',
                          '24115','28444','81595','19110','21843',
                          '74933','95125','72069','30400','52483',
                          '54054','84941','19837','52086','95240',
                          '46328','46516','80080','64284','17631',
                          '41474','37464','86121','19426','10861',
                          '24708','38670','69788','82070','58399',
                          '41199','19873','17414','71548','54129',
                          '78695','47308','67943','13480','89214',
                          '42634','63191','63421','95568','24082',
                          '15527','36127','15414','72324','59344',
                          '84091','21940','42671','51646','87291',
                          '11429','16394','15209','54761','74219',
                          '74526','83910','21337','94603','71563',
                          '45026','33312','26816','13946','58247',
                          '28233','82419','94236','43120','40381',
                          '70157','34987','25063','62875','80990',
                          '44460','28924','51093','26482','75963',
                          '67912','28300','95210','16170','12265',
                          '99318','63462','62426','94717','62385',
                          '40387','73611','56618','18909','80395',
                          '61343','15315','16712','14252','65563',
                          '89292','99314','52502','37151','47899',
                          '82556','10022','55078','42525','70952',
                          '67364','26556','10042','86197','46371',
                          '70898','75901','14058','85371','43419',
                          '42286','71848','50147','52066','20276',
                          '16346','76475','54925','13575','53853',
                          '31975','23258','84807','10582','21373',
                          '21734','46435','63064','38472','70925',
                          '11820','21750','15941','15374','40438',
                          '26492','67997','85296','26578','84399',
                          '52935','24985','17820','59760','87584',
                          '18245','26905','40001','21532','41791',
                          '65993','58859','66502','12970','37381',
                          '38209','55086','61808','15995','12144',
                          '52474','64271','52370','31130','27422',
                          '97655','28144','21803','81738','57546',
                          '53334','35499','59648','59406','37685',
                          '34405','42088','12551','75678','36625',
                          '43657','68913','35658','21797','48960',
                          '96863','32303','99738','31486','48135',
                          '38369','53712','43743','32846','94238',
                          '55143','96953','27666','35548','28876',
                          '28729','63570','95072','13714','61481',
                          '33351','41300','16540','17014','67490',
                          '26209','36361','88254','29190','31756',
                          '46370','14377','69915','69589')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
