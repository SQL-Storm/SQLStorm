
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '54233','66464','68335','80845','77374','36702',
                          '81643','11176','30199','90296','87043',
                          '74575','18242','41184','92256','45425',
                          '35753','61201','89012','97914','76323',
                          '98011','31405','14145','12308','22005',
                          '31463','57885','29280','77006','27055',
                          '81560','79018','17641','37113','10153',
                          '62849','60564','33378','17565','68864',
                          '68420','40365','77994','40377','76458',
                          '14840','48735','83133','27596','96269',
                          '17431','15825','99874','67809','54542',
                          '25961','12536','78998','16114','62805',
                          '55660','33257','53971','58845','20764',
                          '61709','68969','12432','64429','27267',
                          '18931','36552','67361','31989','19763',
                          '14021','55892','41032','87613','84873',
                          '30148','72375','90896','35079','54591',
                          '12735','65864','93376','77061','52332',
                          '44601','22220','69522','41535','71891',
                          '43400','41423','29487','42942','19859',
                          '58226','12285','68892','38769','91661',
                          '16640','98439','91073','93614','58276',
                          '61837','81425','30929','46148','28789',
                          '51885','70323','14821','95168','76707',
                          '40113','73309','10822','70483','65051',
                          '80583','18277','95747','58130','34453',
                          '10188','15343','95313','55757','36483',
                          '14050','66622','83732','64741','82651',
                          '23707','69304','46395','20998','40720',
                          '61511','19975','26407','39129','12649',
                          '82828','26816','39335','78382','33165',
                          '76247','37031','39003','68874','55199',
                          '24232','80662','12889','86183','28742',
                          '21812','37136','25062','58181','47780',
                          '35860','73809','12640','77703','20545',
                          '95749','55496','42061','28946','92213',
                          '37775','51427','61849','73956','90796',
                          '47450','13106','34115','12142','97590',
                          '68777','40845','67434','29896','19380',
                          '57202','33619','11735','13571','93309',
                          '60867','20237','15276','67738','36284',
                          '98169','61522','29015','46256','15828',
                          '62025','41087','33642','77627','61070',
                          '24075','93097','83203','31770','19843',
                          '66514','13360','32783','27589','25951',
                          '20456','76178','45368','49134','88127',
                          '32723','79390','42987','39973','69912',
                          '11255','15952','11802','40538','13422',
                          '15351','66383','24070','44120','14249',
                          '10090','69081','49938','54478','36202',
                          '51766','68282','87492','94642','71495',
                          '19996','99778','35702','76737','54221',
                          '48074','77685','89634','46607','51114',
                          '50346','93252','42212','56183','53177',
                          '77997','45262','55526','14721','27213',
                          '27486','17390','28879','77909','35413',
                          '46779','61818','83308','16012','86156',
                          '32593','78964','73092','38229','22901',
                          '44659','33720','32372','13046','26534',
                          '88795','61074','87623','42102','24731',
                          '20288','94983','20283','49011','48732',
                          '54348','48048','56529','19849','10398',
                          '76748','52553','75020','94631','65060',
                          '11152','10348','70149','84262','45570',
                          '32415','10765','22734','67714','28138',
                          '53474','10926','83108','95465','46371',
                          '25806','19109','31504','75133','20214',
                          '11183','95657','36715','95275','29732',
                          '71525','23395','63376','75840','40086',
                          '12296','79858','58184','58149','69690',
                          '74041','41585','11089','18632','28989',
                          '28382','69328','79490','14949','73448',
                          '40121','59636','77425','74392','14516',
                          '22086','69413','26643','52559','85820',
                          '76860','15678','32072','46364','49812',
                          '58610','93848','44753','61850','56279',
                          '38305','60862','45785','70654','47510',
                          '26107','22026','69756','80046','27702',
                          '26776','15181','78107','50658','65161',
                          '79745','32130','79349','45699')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
