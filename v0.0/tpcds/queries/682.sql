
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '60795','10775','84161','33947','65601','22442',
                          '22658','86109','73750','15179','43664',
                          '31391','24093','34379','68353','31965',
                          '26581','12051','42519','11307','77078',
                          '76697','10600','17818','68747','26996',
                          '76855','67565','38558','60668','70468',
                          '37145','11291','36752','57695','58758',
                          '84488','83673','45741','50751','97327',
                          '14544','63301','79846','91239','91370',
                          '37991','15172','24817','34438','87951',
                          '43998','42096','72051','76646','42413',
                          '33983','76379','91232','77206','62920',
                          '73707','73890','25849','77551','95682',
                          '22599','31048','65965','42153','16723',
                          '56716','93096','92422','71331','31730',
                          '77203','40965','86760','78971','86047',
                          '10535','66256','58122','16608','91642',
                          '70954','63236','45151','51117','20083',
                          '14832','87572','90084','54609','93041',
                          '90191','31826','36814','97372','79732',
                          '31178','28100','58059','61557','15049',
                          '29786','83204','37784','54274','29922',
                          '75711','10520','20646','68953','43202',
                          '24658','90193','41082','14376','24075',
                          '83583','81185','16041','63704','12078',
                          '11284','43886','13306','25712','36883',
                          '97838','23640','59040','35641','78405',
                          '43604','49091','71408','46713','12442',
                          '66465','41578','76495','65186','77359',
                          '46948','10784','90316','98498','26174',
                          '74641','72590','78925','29753','41110',
                          '49699','73082','94897','16579','43049',
                          '43969','74521','57028','31051','42797',
                          '75297','69815','51695','40305','39846',
                          '84082','79349','56001','37876','61298',
                          '63797','81403','73349','58870','19017',
                          '62632','76026','62718','57541','51264',
                          '69907','53498','38646','35316','61246',
                          '20468','55164','29331','92159','68201',
                          '94461','22628','34958','76411','73362',
                          '45260','74773','73982','62177','92838',
                          '94063','52959','49192','45407','75872',
                          '21281','89681','16043','41238','83245',
                          '50009','44460','13153','76886','59817',
                          '87304','54761','95059','54853','20991',
                          '12476','26354','31299','30886','62180',
                          '68842','43737','99463','60406','41189',
                          '92998','59321','51157','46368','13304',
                          '30641','38204','29176','15583','53897',
                          '96034','76677','23038','67967','19871',
                          '81746','84551','72679','27405','60342',
                          '11342','80152','24011','11241','24397',
                          '10744','85117','89617','15685','34882',
                          '38451','45905','97078','91313','15676',
                          '65141','23467','33567','53758','33914',
                          '25047','72948','11115','49941','54440',
                          '25334','36083','20558','89444','36142',
                          '44500','17032','31035','67549','61848',
                          '64402','77290','74867','26577','70116',
                          '65003','68677','30161','28249','81411',
                          '96018','26242','61883','33811','32333',
                          '36798','15883','19043','67746','20745',
                          '46822','33085','44840','28718','50519',
                          '78654','90969','85314','69802','11122',
                          '77448','32058','65033','33066','78475',
                          '44442','17970','34144','40104','68191',
                          '53836','62311','62540','48894','88326',
                          '49997','15214','20013','49242','29698',
                          '32569','46893','15106','46220','92463',
                          '84879','85315','44076','13751','88547',
                          '70896','39557','24657','17076','71459',
                          '40324','26929','59705','50219','57231',
                          '71145','14173','48286','36981','14546',
                          '46127','76159','84362','60235','97619',
                          '88705','50072','47638','44578','31300',
                          '62902','91332','12901','38255','86267',
                          '33726','57612','20106','90229','21939',
                          '11777','40424','32411','96380','60982',
                          '57015','86105','48570','27814','20860',
                          '65473','45926','31245','57248')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 2 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
