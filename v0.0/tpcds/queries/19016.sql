
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '64755','24709','41222','57233','31414','44182',
                          '21886','77428','34894','25237','44136',
                          '50377','16564','82243','26077','96832',
                          '13033','64664','47871','17903','26433',
                          '40604','37211','92677','78556','35974',
                          '18605','56849','48314','63798','15417',
                          '97549','40275','53183','34290','68336',
                          '58365','25764','34593','56817','26923',
                          '57461','18759','38943','95778','82281',
                          '19300','91642','13266','46106','87036',
                          '64306','26707','35472','85103','12890',
                          '50310','81418','79318','79139','53967',
                          '57930','22623','94859','17302','95200',
                          '50564','46796','56065','82607','38606',
                          '83045','56110','10468','45713','59463',
                          '72050','80318','76945','13621','14589',
                          '15081','36081','31371','22801','32631',
                          '97579','31231','68488','16876','41033',
                          '28890','38193','78445','82472','27991',
                          '10706','91729','53276','58546','88203',
                          '24437','60996','14056','22727','44432',
                          '62769','43157','27592','38381','59737',
                          '28751','37058','20536','43345','15456',
                          '77600','12471','54706','52163','32436',
                          '59073','42474','61552','10190','31950',
                          '84610','45164','50530','65000','73883',
                          '71273','15089','29928','39961','40642',
                          '77408','35238','45726','74434','58820',
                          '99339','40889','12552','56638','11808',
                          '53646','38248','87868','17171','63055',
                          '67707','95417','28055','33824','93261',
                          '66612','93795','90319','36241','17082',
                          '79354','77344','24472','49120','67660',
                          '98988','70979','74872','22782','44327',
                          '71734','65913','10344','56648','45199',
                          '15369','33588','18749','69741','75392',
                          '30695','47353','25524','22990','69472',
                          '86299','48440','21585','41639','69627',
                          '56154','10257','23067','80726','13606',
                          '55291','62037','14729','21543','16278',
                          '93799','18834','26683','85033','33719',
                          '14061','15869','26654','11557','13115',
                          '55335','62380','59458','37899','44078',
                          '42170','80872','92000','48373','77272',
                          '81480','29292','47821','40004','55485',
                          '84529','94671','78667','16202','35661',
                          '55234','29330','16052','95933','19727',
                          '58576','58602','61117','47616','43721',
                          '73295','23279','28047','34490','50574',
                          '75423','73431','71815','22170','16703',
                          '62413','12983','83926','20947','44209',
                          '26558','90577','41041','60559','29507',
                          '63897','56167','97306','28283','68892',
                          '53308','44069','38159','46820','74966',
                          '22088','96343','17703','70325','93536',
                          '56908','52559','72115','76867','54661',
                          '58447','17429','12253','26932','38895',
                          '53087','35183','97179','57939','18049',
                          '68563','88489','76057','83422','70386',
                          '34668','93236','81855','28611','75356',
                          '95955','30775','47699','97476','51583',
                          '44970','13022','94841','78120','28129',
                          '30070','16757','47083','44806','75254',
                          '42710','64057','95351','32176','32170',
                          '21212','12027','20855','69306','96442',
                          '20988','67230','96824','63094','32235',
                          '64540','39391','18176','82306','32165',
                          '40603','44441','76831','12918','44926',
                          '54466','87872','85817','34857','23758',
                          '37399','48664','67166','41535','23136',
                          '70009','91331','18135','17470','46747',
                          '86101','38352','95674','49179','28173',
                          '59835','52794','74329','81078','17286',
                          '88395','28195','81173','65362','28171',
                          '33156','86155','78916','57130','55217',
                          '20056','76909','97380','65975','75187',
                          '69259','71192','72827','61440','52999',
                          '26163','13265','41846','18624','72241',
                          '24505','34935','12247','94039','30533',
                          '52511','92833','89779','48716')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
