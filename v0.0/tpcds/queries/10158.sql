
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '22875','44811','80134','97471','69084','14624',
                          '19860','13798','33678','48644','69505',
                          '19600','43634','17443','97707','88434',
                          '37452','92066','95993','26726','37180',
                          '86743','97681','37782','63199','27332',
                          '73659','28037','86999','69384','78273',
                          '70278','48686','29866','74497','76706',
                          '24906','39907','34550','14949','57426',
                          '62528','65597','25043','45853','11021',
                          '46616','74556','29670','71109','69573',
                          '80327','69919','58411','45526','25389',
                          '29502','69544','59327','59875','56400',
                          '75434','68517','14118','71984','75123',
                          '16666','19212','44057','19238','46745',
                          '18391','17274','94679','58748','51472',
                          '29842','23630','57005','10258','34223',
                          '44953','47853','65612','46487','86104',
                          '15142','58626','77777','52172','11057',
                          '45836','69965','63762','29037','66760',
                          '15333','61526','95004','59329','86214',
                          '78266','23817','78977','60445','16381',
                          '33646','16881','52859','46535','51628',
                          '41968','15369','23440','41012','84471',
                          '84940','14703','49583','68851','74750',
                          '28443','92646','87168','47728','17219',
                          '73667','36124','29589','94536','40203',
                          '18889','60855','79393','95364','88471',
                          '25924','65485','18095','58196','12535',
                          '39975','93500','88105','43975','28905',
                          '95092','91482','54326','23046','67627',
                          '26391','34783','21990','83183','79081',
                          '87220','12321','74102','38950','72491',
                          '17793','11910','87534','12681','22015',
                          '53223','57750','70952','60123','13370',
                          '75558','21024','31783','19750','91907',
                          '29217','75083','52233','19201','42288',
                          '14539','63243','83627','93302','60536',
                          '22999','15183','76242','80910','52559',
                          '73023','33186','22879','22637','22817',
                          '85936','40977','66222','60631','42195',
                          '61069','96060','36920','54502','58277',
                          '99083','68077','10705','92400','71179',
                          '40441','49644','99437','31429','45869',
                          '13330','90435','96633','83981','74375',
                          '20558','61167','35022','95468','35646',
                          '55711','85258','27874','12061','44377',
                          '57341','26153','56090','12237','49605',
                          '49232','70418','11849','46818','45170',
                          '54339','13203','31049','11339','52205',
                          '49947','41896','61772','87905','11037',
                          '39354','23840','69996','93305','25110',
                          '13835','30559','79379','41560','53832',
                          '13486','12814','71351','53848','61335',
                          '93446','32845','31614','12354','14095',
                          '45648','22935','16231','65584','58537',
                          '92634','48958','43000','95138','85311',
                          '23743','27690','39789','43895','62247',
                          '72644','47854','87096','77596','70449',
                          '22386','19174','90058','16051','16166',
                          '56391','76349','42457','66631','13274',
                          '48222','91769','77015','81079','90083',
                          '25176','55072','84886','93474','22741',
                          '48134','33912','88433','80797','21293',
                          '16619','65893','71334','31691','75181',
                          '37475','16916','19336','83947','59966',
                          '37542','46651','87196','14644','26048',
                          '21306','32274','24138','49438','44429',
                          '27230','27762','45002','49423','34110',
                          '94509','18782','61860','88936','47090',
                          '99864','35069','39875','31957','21315',
                          '56542','29230','23193','82763','86627',
                          '55561','71849','19847','82866','81246',
                          '66941','79867','88789','97257','11928',
                          '71857','24851','95549','88487','23623',
                          '55981','77409','81705','84565','42634',
                          '66736','36912','57318','84378','65173',
                          '12318','71456','82609','84076','29490',
                          '16520','27335','13092','55424','18227',
                          '99874','13867','71141','95370','79033',
                          '15093','18613','94867','28337')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 1998
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
