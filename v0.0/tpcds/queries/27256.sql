
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '42929','38024','38049','34420','34897','47463',
                          '57120','23203','72580','65634','31337',
                          '38476','96208','46548','84854','21907',
                          '70630','69408','21581','81158','92994',
                          '23290','56661','95014','26402','11761',
                          '85340','76707','77724','14060','55426',
                          '22600','97181','16403','65476','82775',
                          '75026','89787','83202','60519','33994',
                          '36776','24379','60412','39637','25212',
                          '46334','50805','34373','71277','14794',
                          '23329','39254','71786','14376','79170',
                          '13890','34194','30923','12589','41164',
                          '30631','25814','52114','50328','19882',
                          '13804','46999','58915','24747','10626',
                          '39169','25068','38461','38877','54382',
                          '80973','16553','41453','70304','82858',
                          '63781','96661','13295','45182','20500',
                          '26859','30961','39351','25797','78293',
                          '16554','47408','20635','11460','59645',
                          '29141','19729','55858','61716','31401',
                          '14364','16582','85006','12945','98451',
                          '56799','84738','75720','41059','74052',
                          '47441','17882','45580','25791','16577',
                          '47118','50776','96960','93946','92510',
                          '21243','67176','18965','12391','47094',
                          '25055','45457','47607','33240','42715',
                          '53895','56489','60064','78391','68539',
                          '20246','23773','47406','48559','21571',
                          '67621','87778','20308','46733','26068',
                          '64155','10155','67483','54297','19921',
                          '23383','91174','12922','56861','91396',
                          '12654','29070','50379','72571','52832',
                          '28716','60382','80008','71216','83379',
                          '23708','78667','41627','26181','27853',
                          '46916','39840','10095','29941','54055',
                          '38508','19227','55740','12500','11880',
                          '27453','49887','56189','69499','78555',
                          '32763','10309','10995','94090','94678',
                          '29324','29732','32346','82092','31321',
                          '11280','51281','17335','31360','20421',
                          '72229','51736','84615','16722','62083',
                          '61026','18390','13310','40917','11984',
                          '86301','47838','45291','16193','49382',
                          '30769','53240','12963','62193','78707',
                          '81658','13459','35282','97851','43782',
                          '47247','17393','56097','78168','40855',
                          '14409','84477','24061','51184','11708',
                          '22261','68259','24309','82636','14490',
                          '94528','66588','67644','42465','46486',
                          '57372','86692','11042','14446','62678',
                          '81725','84617','24924','46086','37958',
                          '11987','27059','21248','64805','98970',
                          '53342','98923','73705','33651','96014',
                          '23215','50084','42857','97631','49749',
                          '39781','33778','21555','70431','11674',
                          '70479','91983','15027','40246','55859',
                          '24893','64568','63524','92669','89223',
                          '83364','16927','92188','77887','13030',
                          '70965','12786','20072','72715','45862',
                          '89834','47803','76135','95217','91561',
                          '58468','68084','25265','37815','33130',
                          '28327','33940','98736','77172','60560',
                          '71486','49748','38567','87543','79090',
                          '92419','29001','78345','17565','33585',
                          '75636','32109','11737','21018','58334',
                          '19396','23475','19274','82333','44288',
                          '30128','85636','48880','90045','24007',
                          '51672','80142','79244','37691','27650',
                          '94016','63032','21320','11388','28348',
                          '17503','91650','32421','43528','16878',
                          '21297','11461','72710','86250','28487',
                          '35591','60741','65787','19739','90718',
                          '96379','49722','83174','11907','20954',
                          '28230','45077','91116','10805','13888',
                          '86921','75934','18902','22383','68198',
                          '42237','62087','76200','34891','52155',
                          '50258','87991','26350','16482','22218',
                          '29093','62066','56485','17121','12843',
                          '83983','42057','95156','32230','45188',
                          '70722','15920','46034','14043')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
