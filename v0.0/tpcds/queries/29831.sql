
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '19393','49025','20573','19624','41650','49363',
                          '41740','35284','29989','79302','79081',
                          '44660','55394','16533','39963','39225',
                          '12073','49301','91517','65256','10833',
                          '41111','38628','17991','84871','64257',
                          '56827','98327','53868','15041','74415',
                          '62708','13175','23828','59442','77342',
                          '70229','10130','23282','11629','75618',
                          '35606','76415','87473','69576','83623',
                          '51565','85610','52195','13451','48218',
                          '82937','88101','26983','34144','25705',
                          '98184','71897','83101','22515','11946',
                          '21642','84322','55023','50350','14858',
                          '45575','91926','22575','84296','33805',
                          '26318','19755','92082','58231','30684',
                          '11887','60581','27349','71143','24201',
                          '31159','17062','78567','45034','23689',
                          '56485','89831','99766','18963','14968',
                          '63261','57170','57883','55105','11626',
                          '53481','30814','77886','98484','21534',
                          '54882','76715','11266','87268','26306',
                          '25154','47438','73703','75330','53596',
                          '87952','50909','41296','37729','62547',
                          '40161','89822','63510','15180','12146',
                          '89131','61417','17406','12675','96252',
                          '13684','51557','19189','95171','24264',
                          '45181','67124','77708','60450','75460',
                          '48877','19514','35670','90190','27577',
                          '16523','33627','64812','86981','12061',
                          '30993','99517','31257','75743','75596',
                          '75493','95076','41786','23442','89779',
                          '32063','85125','14755','41820','97263',
                          '99385','86565','96385','72496','19600',
                          '92854','63925','64056','71767','83050',
                          '49910','79546','22994','94656','10628',
                          '88358','59319','78117','12827','32373',
                          '67453','17904','19452','13295','44145',
                          '35019','61922','39527','35266','58517',
                          '25979','19147','65525','89099','64445',
                          '63346','96908','51352','19094','93157',
                          '90770','38840','39015','69149','96764',
                          '40898','80888','18960','86666','66450',
                          '64042','37047','98664','88962','60850',
                          '40820','42863','26161','10551','86793',
                          '32421','29397','80859','54851','10588',
                          '17894','30348','79331','16717','38660',
                          '92139','87829','52453','83118','68814',
                          '54254','35004','80689','47515','97164',
                          '28993','12380','12849','53589','21140',
                          '43806','73383','45502','86064','90887',
                          '21433','70240','61789','42366','22419',
                          '22184','35049','64483','97452','52771',
                          '63432','36009','34565','20346','55475',
                          '36708','48982','51601','59334','98126',
                          '59883','42090','93042','83675','79421',
                          '21804','38335','67525','79317','14476',
                          '65315','74071','29277','22465','79376',
                          '60821','49590','46605','13748','15016',
                          '27892','11175','38223','28526','52028',
                          '94169','17151','38548','89951','84229',
                          '21616','62852','31149','45006','38503',
                          '90229','49332','70169','59028','86208',
                          '93797','15964','86845','23672','59377',
                          '47281','42020','24060','27837','60960',
                          '67667','17231','38822','97582','13583',
                          '41099','35573','84404','19654','43978',
                          '24133','93149','60207','60915','36829',
                          '57317','58071','19121','16203','13701',
                          '44444','76489','32994','83447','51512',
                          '31099','95247','66778','53881','46273',
                          '82376','38279','46879','84713','34342',
                          '11333','30380','23024','49166','80153',
                          '45807','15012','19918','90632','26764',
                          '11038','35860','76640','67639','38618',
                          '91138','13653','20063','30036','32302',
                          '88590','44916','30395','41667','20558',
                          '67803','59299','34167','36721','97080',
                          '27265','64081','29823','94716','87590',
                          '84648','18563','77558','42187','50317',
                          '38144','77193','35682','73321')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2001
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
