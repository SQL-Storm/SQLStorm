
-- end query 62 in stream 0 using template query41.tpl
-- start query 63 in stream 0 using template query8.tpl
select  s_store_name
      ,sum(ss_net_profit)
 from store_sales
     ,date_dim
     ,store,
     (select ca_zip
     from (
      SELECT substr(ca_zip,1,5) ca_zip
      FROM customer_address
      WHERE substr(ca_zip,1,5) IN (
                          '57132','70244','37175','26636','60568','70694',
                          '69639','34418','94967','13639','31377',
                          '87963','24038','27726','19798','70865',
                          '24435','72728','70533','32274','28208',
                          '40731','95810','95940','26768','21038',
                          '29588','37531','58250','59403','60629',
                          '55269','59562','85761','21415','35794',
                          '60517','32152','26093','53775','54648',
                          '24537','20789','72867','57927','15680',
                          '11220','55818','61846','41134','90545',
                          '99559','78932','60242','18012','15175',
                          '37297','27703','86204','93006','61151',
                          '91060','37821','48255','12703','16300',
                          '37527','87612','71715','57583','13803',
                          '25175','19366','98965','23750','38571',
                          '80894','24131','27053','27258','49597',
                          '18463','49404','93484','75596','11056',
                          '17331','18193','94175','17891','98462',
                          '37668','99574','54642','11099','56533',
                          '83308','63829','76297','70823','16870',
                          '27220','38760','86442','93635','52449',
                          '16717','43417','22356','94311','22491',
                          '48829','22935','91770','84699','91314',
                          '42759','88656','80139','59103','81321',
                          '37543','15934','93683','31743','28843',
                          '22001','50613','78765','42494','19434',
                          '18380','80106','67139','41088','73816',
                          '30111','95599','48643','61540','15295',
                          '34305','60987','19309','34755','43244',
                          '44569','20355','88865','76702','23168',
                          '76828','22402','14067','10579','66608',
                          '63695','98143','37827','57111','13631',
                          '63211','68640','80807','21196','81265',
                          '64703','44491','30791','44340','18761',
                          '89285','35908','99535','95359','86835',
                          '73049','12206','15712','21139','10234',
                          '80566','60387','34315','24783','13069',
                          '93225','74812','38537','79597','32629',
                          '17654','13907','34102','43422','14723',
                          '99763','68531','13416','17823','60347',
                          '20910','32030','25131','79410','60949',
                          '19545','60280','53117','15114','74710',
                          '26688','11567','99746','67338','87299',
                          '75164','43987','38616','73079','59616',
                          '47340','28733','43510','49211','73275',
                          '88918','62749','45642','94680','43099',
                          '89864','99154','49089','96254','14430',
                          '42531','84963','54919','65868','36071',
                          '71906','31278','67830','28632','11660',
                          '66181','28304','61392','27081','69099',
                          '27451','11711','76829','29642','65455',
                          '73647','88284','62640','71140','54356',
                          '67674','87455','35656','54105','19607',
                          '86066','12051','18569','62548','33135',
                          '58728','10029','63460','42652','81900',
                          '70301','74657','35076','33424','21919',
                          '51188','96803','37424','80973','41430',
                          '32851','13062','94727','12319','11809',
                          '33684','28124','42131','24866','41752',
                          '51567','43168','71088','61744','76196',
                          '72294','25897','51282','64509','47170',
                          '87375','48775','89425','75059','38001',
                          '53734','58716','34477','39702','30833',
                          '20456','96085','85382','17541','33804',
                          '75474','47815','90508','83057','85269',
                          '47688','53293','21283','59210','59659',
                          '57780','86123','23601','15563','27820',
                          '55110','19507','80351','51870','55370',
                          '24496','38485','39345','32535','46811',
                          '56710','31009','63434','68681','94155',
                          '29603','10761','39793','19548','60372',
                          '85283','59307','13791','56510','38464',
                          '20223','96886','70111','48650','33425',
                          '80678','39500','71596','24400','37776',
                          '38942','36717','99767','18500','78557',
                          '63824','33685','56421','35055','21480',
                          '66365','13910','43322','16127','11864',
                          '26493','26474','17025','38370','79662',
                          '80455','55303','32534','19826','91678',
                          '18246','45054','52788','28821')
     intersect
      select ca_zip
      from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt
            FROM customer_address, customer
            WHERE ca_address_sk = c_current_addr_sk and
                  c_preferred_cust_flag='Y'
            group by ca_zip
            having count(*) > 10)A1)A2) V1
 where ss_store_sk = s_store_sk
  and ss_sold_date_sk = d_date_sk
  and d_qoy = 1 and d_year = 2000
  and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2))
 group by s_store_name
 order by s_store_name
 limit 100;
